<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>有一个 $n \times m$ 的矩阵，请你选出其中 $k$ 个子矩阵，使得这个 $k$ 个子矩阵分值之和最大。注意：选出的 $k$ 个子矩阵不能相互重叠。</p>

<h3>输入格式</h3>
<p>第一行包含三个正整数 $n, m, k$ ($n \leq 100, m \leq 2, k \leq 10$)。</p>
<p>接下来 $n$ 行描述矩阵每行中的每个元素 $a_{ij}$ 的分值 ($|a_{ij}| \leq 32767$)。</p>

<h3>输出格式</h3>
<p>输出一行一个整数，为 $k$ 个子矩阵分值之和最大为多少。</p>

<h3>题解</h3>
<p>注意到 $m = 2$，于是我们只需以 $m = 1$ 和 $m = 2$ 分开讨论即可。</p>
<p>当 $m = 1$ 时，是一道<del>基础</del> DP 题。只需记 $f_{i, j}$ 表示前 $i$ 个数共分为 $j$ 段，且 $i$ 在第 $j$ 段的最大值，$g_{i, j}$ 表示 $i$ 不在第 $j$ 段的最大值，则有</p>
\begin{align}
f_{i, j} &amp;= \max \{f_{i-1, j}, g_{i-1, j-1}\} + a_{i1} \\
g_{i, j} &amp;= \max \{f_{i-1, j}, g_{i-1, j}\}
\end{align}
<p>最后答案即为 $\max \{f_{n, k}, g_{n, k}\}$。接下来考虑 $m = 2$ 的情形 (双行/列 DP)。类似地，记录状态时记录处理到了第 $i$ 行，并且有 $j$ 个子矩阵，接下来是第 $i$ 行的状况，有如下 5 种：</p>
<ol>
<li>第 $i$ 行两个数都未被选择。</li>
<li>第 $i$ 行左边 (第一列) 的数被选择了，右边 (第二列) 的数未被选择。</li>
<li>第 $i$ 行左边的数未被选择，右边的数被选择了。</li>
<li>第 $i$ 行的两个数都被选择，且它们在<strong>两个宽为 $1$ 的矩阵</strong>中。</li>
<li>第 $i$ 行的两个数都被选择，且它们在<strong>一个宽为 $2$ 的矩阵</strong>中。</li>
</ol>
<p>分别把这 5 种情况的最大值记为 $f_{i, j, 0}, f_{i, j, 1}, \cdots, f_{i, j, 4}$ 显然有边界 $f_{i, 0, 0} = 0$，其它<strong>均置为 $- \infty$</strong>。考虑它们的转移：</p>
<p>对于 $f_{i, j, 0}$，那么只需保证前面 $i-1$ 行共有 $j-1$ 个子矩阵即可，即 $$ f_{i, j, 0} = \max_{0 \leq k \leq 4} f_{i-1, j, k} $$</p>
<p>对于 $f_{i, j, 1}$，那么上一行为第 2 种或第 4 种情况，则矩阵数目不会增加，否则矩阵数目会 $+ 1$，即 $$ f_{i, j, 1} = \max \left\{ f_{i-1, j-1, 0}, f_{i-1, \color{red} j, 1}, f_{i-1, j-1, 2}, f_{i-1, \color{red} j, 3}, f_{i-1, j-1, 4} \right\} + a_{i1} $$</p>
<p>$f_{i, j, 2}$ 则完全同理：$$ f_{i, j, 2} = \max \left\{ f_{i-1, j-1, 0}, f_{i-1, j-1, 1}, f_{i-1, \color{red} j, 2}, f_{i-1, \color{red} j, 3}, f_{i-1, j-1, 4} \right\} + a_{i2} $$</p>
<p>对于 $f_{i, j, 3}$ ($j \geq 2$)，如果上一行为第 4 种情况，则矩阵数目不会增加；如果上一行为第 2 种或第 3 种情况，则矩阵数目会 $+ 1$，否则矩阵数目 $+ 2$，故转移为 $$ f_{i, j, 3} = \max \left\{ f_{i-1, \color{green} {j-2}, 0}, f_{i-1, j-1, 1}, f_{i-1, j-1, 2}, f_{i-1, \color{red} j, 3}, f_{i-1, \color{green} {j-2}, 4} \right\} + a_{i1} + a_{i2} $$</p>
<p>最后是 $f_{i, j, 4}$，显然只有上一行也为第 5 种情况时才不会增加矩阵数目：$$ f_{i, j, 4} = \max \left\{ f_{i-1, j-1, 0}, f_{i-1, j-1, 1}, f_{i-1, j-1, 2}, f_{i-1, j-1, 3}, f_{i-1, \color{red} j, 4} \right\} + a_{i1} + a_{i2} $$</p>
<p>因此最后的答案即为 $\max\limits_{0 \leq i \leq 4} f_{n, k, i}$，时间复杂度 $O(nk)$。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">136</span>
<span class="sh_preproc">#define</span> K <span class="sh_number">17</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_type">int</span> n<span class="sh_symbol">,</span> m<span class="sh_symbol">,</span> k<span class="sh_symbol">;</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">up</span><span class="sh_symbol">(</span><span class="sh_type">int</span> <span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_keyword">const</span> <span class="sh_type">int</span> y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>x <span class="sh_symbol">&lt;</span> y <span class="sh_symbol">?</span> x <span class="sh_symbol">=</span> y <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
<span class="sh_keyword">inline</span> <span class="sh_type">int</span> <span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_type">int</span> x<span class="sh_symbol">,</span> <span class="sh_keyword">const</span> <span class="sh_type">int</span> y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> x <span class="sh_symbol">&lt;</span> y <span class="sh_symbol">?</span> y <span class="sh_symbol">:</span> x<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_keyword">inline</span> <span class="sh_type">int</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_type">int</span> count<span class="sh_symbol">,</span> <span class="sh_symbol">...)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> ret <span class="sh_symbol">=</span> INT_MIN<span class="sh_symbol">,</span> i<span class="sh_symbol">;</span> <span class="sh_usertype">va_list</span><span class="sh_normal"> </span>p<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_function">va_start</span><span class="sh_symbol">(</span>p<span class="sh_symbol">,</span> count<span class="sh_symbol">),</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> count<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_function">up</span><span class="sh_symbol">(</span>ret<span class="sh_symbol">,</span> <span class="sh_function">va_arg</span><span class="sh_symbol">(</span>p<span class="sh_symbol">,</span> <span class="sh_type">int</span><span class="sh_symbol">));</span>
    <span class="sh_keyword">return</span> <span class="sh_function">va_end</span><span class="sh_symbol">(</span>p<span class="sh_symbol">),</span> ret<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">namespace</span> M1<span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> f<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>K<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>K<span class="sh_symbol">];</span>
    <span class="sh_comment">// f: selected, g: unselected</span>

    <span class="sh_type">void</span> <span class="sh_function">work</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> t<span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>t<span class="sh_symbol">);</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> k<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span>f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> t<span class="sh_symbol">;</span>
                g<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span>f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">]);</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> <span class="sh_function">max</span><span class="sh_symbol">(</span>f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">]));</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">namespace</span> M2<span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> f<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>K<span class="sh_symbol">][</span><span class="sh_number">5</span><span class="sh_symbol">];</span>

    <span class="sh_type">void</span> <span class="sh_function">work</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> u<span class="sh_symbol">,</span> d<span class="sh_symbol">;</span>
        <span class="sh_function">memset</span><span class="sh_symbol">(</span>f<span class="sh_symbol">,</span> <span class="sh_number">192</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span> f<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>u<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>d<span class="sh_symbol">);</span>
            f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> k<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span>
                    f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">]);</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span>
                    f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> u<span class="sh_symbol">;</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span>
                    f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> d<span class="sh_symbol">;</span>
                j <span class="sh_symbol">&gt;=</span> <span class="sh_number">2</span> <span class="sh_symbol">?</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span>
                    f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> u <span class="sh_symbol">+</span> d <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
                f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span>
                    f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> u <span class="sh_symbol">+</span> d<span class="sh_symbol">;</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> <span class="sh_function">Max</span><span class="sh_symbol">(</span><span class="sh_number">5</span><span class="sh_symbol">,</span> f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">][</span><span class="sh_number">1</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">][</span><span class="sh_number">3</span><span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>n<span class="sh_symbol">][</span>k<span class="sh_symbol">][</span><span class="sh_number">4</span><span class="sh_symbol">]));</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>m<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>k<span class="sh_symbol">);</span>
    m <span class="sh_symbol">==</span> <span class="sh_number">1</span> <span class="sh_symbol">?</span> M1<span class="sh_symbol">::</span><span class="sh_function">work</span><span class="sh_symbol">()</span> <span class="sh_symbol">:</span> M2<span class="sh_symbol">::</span><span class="sh_function">work</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p><strong>坑1：</strong>注意数组置为 $- \infty$，否则会出现 $f_{i, 0, 1} = 0$ 之类的导致一段变成两段等奇怪的情况。</p>

