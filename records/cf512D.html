<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>scx 计划去一个小岛度假。</p>
<p>小岛上共有 $n$ 个景点，有 $m$ 条双向道路连接它们。scx 有 $k$ 天的度假时间，每一天她都恰好会去参观一个 (之前没去过的) 景点。</p>
<p>在这个小岛上，有一个<del>奇怪的</del>规则：如果一个景点有至少两个<strong>相邻</strong>的且<strong>之前没有游览过</strong>的景点，则不能游览该景点 (当然，scx 也一样)。</p>
<p>起初，scx 没有游览任何景点。在满足规则的情况下，她可以以<strong>任意顺序</strong>游览景点，即使相邻两天的景点没有通过道路直接或间接连接 (因为 scx 可以用船呀)。</p>
<p>scx 想要知道，对于她的度假时间 $k$ 从 $0$ 到 $n$，一共有多少种<strong>本质不同且满足规则</strong>的旅游方案，由于方案数可能很大，请模 $10^9 + 9$ 输出。</p>

<h3>输入格式</h3>
<p>第一行包含两个整数 $n, m$ ($1 \leq n \leq 100, 0 \leq m \leq \dbinom n2$)，表示景点的个数和双向道路的个数。</p>
<p>接下来的 $m$ 行，每行包含两个整数 $a_i$ 和 $b_i$ ($1 \leq a_i, b_i \leq n$)，描述一条道路，保证没有自环和重边。</p>

<h3>输出格式</h3>
<p>输出 $n + 1$ 行，每行一个整数，第 $i + 1$ 行的整数表示当 $k = i$ 时，<strong>本质不同且满足规则</strong>的旅游方案数模 $10^9 + 9$ 的值。</p>

<h3>题解</h3>
<p>可以发现，如果有 $h$ 个城市首尾相接形成环，则无论如何，scx 是无法去这些景点的。<del>(所以这个规则好奇怪呀)</del></p>
<p>更进一步的是，如果有多个<strong>互相连通的</strong>环，则这些环以及它们之间的部分，scx 也无法到达。(scx: ...)</p>
<p>因此，对于每个连通块，可以把所有的环及其之间的部分缩成一个点。</p>
<p>由于数据规模较小，可以使用类似 Topo 排序的思想，将度不超过 $1$ 的节点逐次删除，直到所有的顶点 ($0$ 个或多个) 的度都 $&gt; 1$，那么那些点可以看作是<strong>不可访问的</strong>。</p>
<p>于是，每个连通块最终都可以转成一棵树，具体地，有两种情况：</p>
<ol>
<li>有根树，根就是若干个连通块缩成的点，是<strong>不可访问的</strong>。</li>
<li>无根树，没有进行过缩点，所有点均可访问。</li>
</ol>
<p>先看第一种情况，由于根 $r$ 不可访问，因此记 $g_{i, j}$ 为以 $i$ 为根的子树中，一共游览 $j$ 个点的方案数。</p>
<p>类似地，使用背包。记 $c_1, c_2, \cdots, c_{\lambda_i}$ 为 $i$ 的 $\lambda_i$ 个子节点，记 $f_{c_k, j}$ 表示以 $i$ 为根的子树中，只在 $c_1, c_2, \cdots, c_k$ 中游览，一共游览了 $j$ 个点的方案数，则 $g_{i, j} = f_{c_{\lambda_i}, j}$，且 $f_{c_k, j}$ 的转移如下：</p>
<p>$$ f_{c_k, j} = \sum_{l=0}^j f_{c_{k-1}, j-l} \cdot g_{c_k, l} \cdot \binom jk $$</p>
<p>如果 $i$ 不是总根，则 $g_{i, \mathrm{size}(i)} = g_{i, \mathrm{size}(i) - 1}$，其中 $\mathrm{size}(x)$ 表示以 $x$ 为根的子树大小，那么这个连通块的答案就是 $g_{r, k}$，时间复杂度 $O(n^3)$，<strong>$n$ 为树的大小</strong> $\mathrm{size}(r)$。</p>
<p>再来看第二种情况，我们可以<strong>以任意一个点 $r$ 为根</strong>，则对于任意一个游览 $j$ 个点的方案，有 $n - j$ 个点未被访问，那么，如果 $j &lt; n$，这个方案会被重复计算 $n - j$ 次 (以它们任意一个点为根)，如果 $j = n$，显然不会被重复计算。</p>
<p>那么，可以把任意一个点为根的答案都统计出来，最后除以一个 $\max\{1, n - k\}$ 就可以了，时间复杂度 $O(n^4)$。</p>
<p>最后，仅需将 $C$ 个连通块合并，这也不难，记 $a_{i, j}$ 表示原先处理的第 $i$ 个连通块中，游览 $j$ 个点的方案数，$h_{i, j}$ 表示前 $i$ 个连通块中，游览 $j$ 个点的方案数，则</p>
<p>$$ h_{i, j} = \sum_{k=0}^j h_{i-1, j-k} \cdot a_{i, k} \cdot \binom jk $$</p>
<p>答案为 $h_{C, k}$，$k$ 从 $0$ 到 $n$，总时间复杂度 $O(n^4)$。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> maxV <span class="sh_number">108</span>
<span class="sh_preproc">#define</span> maxE <span class="sh_number">10054</span>
<span class="sh_preproc">#define</span> next next1
<span class="sh_preproc">#define</span> <span class="sh_function">ad</span><span class="sh_symbol">(</span>x<span class="sh_symbol">)</span> <span class="sh_symbol">((</span>x <span class="sh_symbol">-</span> <span class="sh_number">1</span> <span class="sh_symbol">^</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">)</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_keyword">typedef</span> <span class="sh_type">int</span> intv<span class="sh_symbol">[</span>maxV<span class="sh_symbol">];</span>
<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> ll<span class="sh_symbol">,</span> llm<span class="sh_symbol">[</span>maxV<span class="sh_symbol">][</span>maxV<span class="sh_symbol">];</span>
<span class="sh_keyword">const</span> <span class="sh_usertype">ll</span><span class="sh_normal"> </span>mod <span class="sh_symbol">=</span> <span class="sh_number">1000000009</span><span class="sh_symbol">;</span>

<span class="sh_keyword">struct</span><span class="sh_normal"> </span><span class="sh_classname">edge</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> u<span class="sh_symbol">,</span> v<span class="sh_symbol">;</span> <span class="sh_type">bool</span> en<span class="sh_symbol">;</span>
    <span class="sh_function">edge</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> u0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_type">int</span> v0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">):</span> <span class="sh_function">u</span><span class="sh_symbol">(</span>u0<span class="sh_symbol">),</span> <span class="sh_function">v</span><span class="sh_symbol">(</span>v0<span class="sh_symbol">),</span> <span class="sh_function">en</span><span class="sh_symbol">(</span><span class="sh_keyword">false</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_type">int</span> V<span class="sh_symbol">,</span> E<span class="sh_symbol">,</span> _E <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_type">int</span> u<span class="sh_symbol">,</span> v<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">;</span>
<span class="sh_usertype">edge</span><span class="sh_normal"> </span>e<span class="sh_symbol">[</span>maxE<span class="sh_symbol">],</span> _e<span class="sh_symbol">[</span>maxE<span class="sh_symbol">];</span>
<span class="sh_type">int</span> next<span class="sh_symbol">[</span>maxE<span class="sh_symbol">],</span> _next<span class="sh_symbol">[</span>maxE<span class="sh_symbol">],</span> cnt <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> ccnt <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_usertype">intv</span><span class="sh_normal"> </span>first<span class="sh_symbol">,</span> _first<span class="sh_symbol">,</span> com<span class="sh_symbol">,</span> deg<span class="sh_symbol">,</span> que<span class="sh_symbol">,</span> top<span class="sh_symbol">,</span> size<span class="sh_symbol">;</span>
<span class="sh_usertype">ll</span><span class="sh_normal"> </span>inv<span class="sh_symbol">[</span>maxV<span class="sh_symbol">];</span>
<span class="sh_usertype">llm</span><span class="sh_normal"> </span>f<span class="sh_symbol">,</span> g<span class="sh_symbol">,</span> res<span class="sh_symbol">,</span> C<span class="sh_symbol">;</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">down</span><span class="sh_symbol">(</span><span class="sh_type">int</span> <span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_keyword">const</span> <span class="sh_type">int</span> y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>x <span class="sh_symbol">&gt;</span> y <span class="sh_symbol">?</span> x <span class="sh_symbol">=</span> y <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">addedge</span><span class="sh_symbol">(</span><span class="sh_type">int</span> u<span class="sh_symbol">,</span> <span class="sh_type">int</span> v<span class="sh_symbol">,</span> <span class="sh_type">int</span> id<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>e<span class="sh_symbol">[</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">edge</span><span class="sh_symbol">(</span>u<span class="sh_symbol">,</span> v<span class="sh_symbol">);</span> next<span class="sh_symbol">[</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>u<span class="sh_symbol">];</span> first<span class="sh_symbol">[</span>u<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> id<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">_addedge</span><span class="sh_symbol">(</span><span class="sh_type">int</span> u<span class="sh_symbol">,</span> <span class="sh_type">int</span> v<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>_e<span class="sh_symbol">[++</span>_E<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">edge</span><span class="sh_symbol">(</span>u<span class="sh_symbol">,</span> v<span class="sh_symbol">);</span> _next<span class="sh_symbol">[</span>_E<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> _first<span class="sh_symbol">[</span>u<span class="sh_symbol">];</span> _first<span class="sh_symbol">[</span>u<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> _E<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">dfs</span><span class="sh_symbol">(</span><span class="sh_type">int</span> x<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> y<span class="sh_symbol">;</span>
    com<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> ccnt<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>com<span class="sh_symbol">[</span>y <span class="sh_symbol">=</span> e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>v<span class="sh_symbol">])</span>
            <span class="sh_function">dfs</span><span class="sh_symbol">(</span>y<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">bfs</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> h<span class="sh_symbol">,</span> t <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> x<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> y<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>deg<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;=</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>deg<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span> que<span class="sh_symbol">[</span>t<span class="sh_symbol">++]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>h <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> h <span class="sh_symbol">&lt;</span> t<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>h<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x <span class="sh_symbol">=</span> que<span class="sh_symbol">[</span>h<span class="sh_symbol">]];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(~</span>deg<span class="sh_symbol">[</span>y <span class="sh_symbol">=</span> e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>v<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_symbol">--</span>deg<span class="sh_symbol">[</span>y<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;=</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>deg<span class="sh_symbol">[</span>y<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span> que<span class="sh_symbol">[</span>t<span class="sh_symbol">++]</span> <span class="sh_symbol">=</span> y<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
            e<span class="sh_symbol">[</span><span class="sh_function">ad</span><span class="sh_symbol">(</span>i<span class="sh_symbol">)].</span>en <span class="sh_symbol">=</span> e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>en <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">DP_rooted</span><span class="sh_symbol">(</span><span class="sh_type">int</span> x<span class="sh_symbol">,</span> <span class="sh_type">int</span> px<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">,</span> y<span class="sh_symbol">,</span> la <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    size<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> _first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> _next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">((</span>y <span class="sh_symbol">=</span> _e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>v<span class="sh_symbol">)</span> <span class="sh_symbol">!=</span> px<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">DP_rooted</span><span class="sh_symbol">(</span>y<span class="sh_symbol">,</span> x<span class="sh_symbol">);</span>
            size<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> size<span class="sh_symbol">[</span>y<span class="sh_symbol">];</span>
        <span class="sh_cbracket">}</span>
    f<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> _first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> _next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">((</span>y <span class="sh_symbol">=</span> _e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>v<span class="sh_symbol">)</span> <span class="sh_symbol">!=</span> px<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> size<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> <span class="sh_symbol">~</span>j<span class="sh_symbol">;</span> <span class="sh_symbol">--</span>j<span class="sh_symbol">)</span>
                <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;=</span> j <span class="sh_symbol">&amp;&amp;</span> k <span class="sh_symbol">&lt;=</span> size<span class="sh_symbol">[</span>y<span class="sh_symbol">];</span> <span class="sh_symbol">++</span>k<span class="sh_symbol">)</span>
                    <span class="sh_symbol">(</span>f<span class="sh_symbol">[</span>y<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> f<span class="sh_symbol">[</span>la<span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> k<span class="sh_symbol">]</span> <span class="sh_symbol">*</span> g<span class="sh_symbol">[</span>y<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">%</span> mod <span class="sh_symbol">*</span> C<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
            la <span class="sh_symbol">=</span> y<span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_function">memcpy</span><span class="sh_symbol">(</span>g<span class="sh_symbol">[</span>x<span class="sh_symbol">],</span> f<span class="sh_symbol">[</span>la<span class="sh_symbol">],</span> maxV <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(~</span>px<span class="sh_symbol">)</span> g<span class="sh_symbol">[</span>x<span class="sh_symbol">][</span>size<span class="sh_symbol">[</span>x<span class="sh_symbol">]]</span> <span class="sh_symbol">=</span> g<span class="sh_symbol">[</span>x<span class="sh_symbol">][</span>size<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">];</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">DP_unrooted</span><span class="sh_symbol">(</span><span class="sh_type">int</span> id<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> sz<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>com<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> id<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">memset</span><span class="sh_symbol">(</span>f<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span> <span class="sh_function">memset</span><span class="sh_symbol">(</span>g<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> g<span class="sh_symbol">);</span>
            <span class="sh_function">DP_rooted</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
            sz <span class="sh_symbol">=</span> size<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span>
                <span class="sh_symbol">(</span>res<span class="sh_symbol">[</span>id<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> g<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">])</span> <span class="sh_symbol">&gt;=</span> mod <span class="sh_symbol">?</span> res<span class="sh_symbol">[</span>id<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">-=</span> mod <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span>
        <span class="sh_symbol">(</span>res<span class="sh_symbol">[</span>id<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">*=</span> inv<span class="sh_symbol">[</span>sz <span class="sh_symbol">-</span> j<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>V<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>E<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> E<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>u<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>v<span class="sh_symbol">);</span>
        <span class="sh_function">addedge</span><span class="sh_symbol">(</span>u<span class="sh_symbol">,</span> v<span class="sh_symbol">,</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
        <span class="sh_function">addedge</span><span class="sh_symbol">(</span>v<span class="sh_symbol">,</span> u<span class="sh_symbol">,</span> i <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
        <span class="sh_symbol">++</span>deg<span class="sh_symbol">[</span>u<span class="sh_symbol">];</span> <span class="sh_symbol">++</span>deg<span class="sh_symbol">[</span>v<span class="sh_symbol">];</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>com<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_cbracket">{</span>top<span class="sh_symbol">[++</span>ccnt<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span>i<span class="sh_symbol">;</span> <span class="sh_function">dfs</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_function">bfs</span><span class="sh_symbol">();</span> inv<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> inv<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> inv<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>mod <span class="sh_symbol">-</span> mod <span class="sh_symbol">/</span> i<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> inv<span class="sh_symbol">[</span>mod <span class="sh_symbol">%</span> i<span class="sh_symbol">]</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>C<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>C<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> i<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span>
            <span class="sh_symbol">(</span>C<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> C<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">+</span> C<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">])</span> <span class="sh_symbol">&gt;=</span> mod <span class="sh_symbol">?</span> C<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">-=</span> mod <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>deg<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">1</span> <span class="sh_symbol">&amp;&amp;</span> top<span class="sh_symbol">[</span>com<span class="sh_symbol">[</span>i<span class="sh_symbol">]]</span> <span class="sh_symbol">&lt;</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> top<span class="sh_symbol">[</span>com<span class="sh_symbol">[</span>i<span class="sh_symbol">]]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> E <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>en<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            u <span class="sh_symbol">=</span> e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>u<span class="sh_symbol">;</span> v <span class="sh_symbol">=</span> e<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>v<span class="sh_symbol">;</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>deg<span class="sh_symbol">[</span>u<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> u <span class="sh_symbol">=</span> top<span class="sh_symbol">[</span>com<span class="sh_symbol">[</span>u<span class="sh_symbol">]];</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>deg<span class="sh_symbol">[</span>v<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> v <span class="sh_symbol">=</span> top<span class="sh_symbol">[</span>com<span class="sh_symbol">[</span>v<span class="sh_symbol">]];</span>
            <span class="sh_function">_addedge</span><span class="sh_symbol">(</span>u<span class="sh_symbol">,</span> v<span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> ccnt<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>top<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">memset</span><span class="sh_symbol">(</span>f<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span> <span class="sh_function">memset</span><span class="sh_symbol">(</span>g<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> g<span class="sh_symbol">);</span>
            <span class="sh_function">DP_rooted</span><span class="sh_symbol">(</span>top<span class="sh_symbol">[</span>i<span class="sh_symbol">],</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">);</span>
            <span class="sh_function">memcpy</span><span class="sh_symbol">(</span>res<span class="sh_symbol">[</span>i<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span>top<span class="sh_symbol">[</span>i<span class="sh_symbol">]],</span> maxV <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">3</span><span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span><span class="sh_keyword">else</span>
            <span class="sh_function">DP_unrooted</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span>
    <span class="sh_function">memset</span><span class="sh_symbol">(</span>f<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span> f<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> ccnt<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">~</span>j<span class="sh_symbol">;</span> <span class="sh_symbol">--</span>j<span class="sh_symbol">)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;=</span> j<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>k<span class="sh_symbol">)</span>
                <span class="sh_symbol">(</span>f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> k<span class="sh_symbol">]</span> <span class="sh_symbol">*</span> res<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">%</span> mod <span class="sh_symbol">*</span> C<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span>
        <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> <span class="sh_symbol">(</span><span class="sh_type">int</span><span class="sh_symbol">)</span>f<span class="sh_symbol">[</span>ccnt<span class="sh_symbol">][</span>j<span class="sh_symbol">]);</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p>这题细节还是蛮多的，由于在模意义下，因此要求 $1$ 到 $n$ 的逆元，于是要写一个线性求逆的玩意儿，DP 转移时还需要二项式系数 (组合数)，虽然可以用逆元求，但我觉得还是直接用递推式预处理掉。</p>
<p><strong>坑1：</strong>这题不需要写 Tarjan，因此会有一个类似 Topo 排序的 <code>bfs()</code>，在这个过程中可以将有用的点和有用的边记录下来，然后开第二个邻接表。</p>
<p><strong>坑2：</strong>还有乘法的时候记得及时取模，加法的时候也可以取模，不过为了加快速度<del>卡常</del>，可以改成超出判断的 <code>?:</code> 运算符，不过前后的变量名不要写错 (然而我当时写错导致答案是负的……)。</p>
