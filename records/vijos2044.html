<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
		<title>[vijos2044][SNOI2018]破解谜题</title>
		<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
		<script type="text/javascript" src="../additional_files/js/sh_main.min.js"></script>
		<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<style>
			.fuchsia-text {color: #F0F}
			.blue-text {color: blue}
		</style>
	</head>
	<body>
		<h3>题目描述</h3>
		<p>这是一道<strong>提交答案题</strong>。</p>
		<blockquote><p>scx 是一名侦探, 最擅长侦破高智商的犯罪，在坏人的 "罪恶都市" 群中有着极大的名声。</p>
		<p>终于有一天, 有着鬼才之称的代号为 X 的坏人忍不住了，想尽一切办法把 scx 抓了起来，捆在了一张椅子上，然后拿出了十张纸，上面有十个谜题，然后告诉她："这里有十个谜题，每个谜题只有提示的线索以及对应的密文，你需要根据线索和密文找出相应的答案，如果不能在规定时间内解出来，那么，你就会被嘿嘿嘿！"</p>
		<p>scx 还很年轻，她可不想被坏人干掉，于是启动了通灵之术，找到了在考场上的你，请你帮她尽量多的破解谜题，来帮助他脱离困境。</p></blockquote>
		<p>有十个谜题，每个谜题为一个字符串，请按某种方法把它拆成若干段，使每一段之间形成一个序列 (原文：请找出隐藏在它里面的序列)，并求出它的前 $k$ 项和模素数 $10^9 + 123$ 的值。</p>
		<h3>数据信息</h3>
		<h4>1.in</h4>
		<pre>Find the sum of the first 5 terms (mod 1000000123) of the hidden sequence inside the following string.
12345678......
</pre>
		<h4>2.in</h4>
		<pre>Find the sum of the first 15 terms (mod 1000000123) of the hidden sequence inside the following string.
1234567891929394959697989995591928777......
</pre>
		<h4>3.in</h4>
		<pre>Find the sum of the first 500 terms (mod 1000000123) of the hidden sequence inside the following string.
12345678964928458952491873953877846869481176715897......
</pre>
		<p>(注：文件 <code>3.in</code> 过大，完整文件下载：<a href="uploads/1.in" download="3.in">3.in</a>)</p>
		<h4>4.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
1234567899192939495969798999919929939949959969979989999991......
</pre>
		<h4>5.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
1234567891929394959697989991992993994995996997998999991999......
</pre>
		<h4>6.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
1234567895556666777788889996676777777787888888898999997777......
</pre>
		<h4>7.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
1111111111111111111111111111111111111111111111111111111111......
</pre>
		<h4>8.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
121212121212121212121212121212121212121212121212121212121212......
</pre>
		<h4>9.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
1234321234321234321234321234321234321234321234321234321234321......
</pre>
		<h4>10.in</h4>
		<pre>Find the sum of the first 100000000000000 terms (mod 1000000123) of the hidden sequence inside the following string.
111322311132231113223111322311132231113223111322311132231113223111322311132231113223......
</pre>

		<h3>输入格式</h3>
		<p>输入文件中只有一个整数，为这一组数据的编号。</p>

		<h3>输出格式</h3>
		<p>对于输入的编号，输出其对应的结果。</p>

		<h3>题解</h3>
		<p>对于<span class="fuchsia-text">第 $1$ 个点</span>，没什么难的，大胆猜测是一个数一段，即 $a_n = n$。手算可得，它的前 $5$ 项和为 $15$。</p>
		<p><span class="fuchsia-text">第 $2$ 个点</span>也是类似地，注意到前 $6$ 个点都是以 "<samp>123456789</samp>" 开头，因此我们可以猜测 $a_n = n$ 当 $1 \leq n \leq 9$，看一下剩下的：<samp>192939495969798999</samp>，那么很可能是两个一段，即 $a_{10} = 19, a_{11} = 29, \cdots, a_{18} = 99$。</p>
		<p>这样还是可以轻松算出它的前 $15$ 项和为 $309$ 的。</p>
		<p>现在来看<span class="fuchsia-text">第 $3$ 个测试点</span>，你会发现它毫无规律，几乎就是随机生成的。怎么办呢？</p>
		<p>我们再回过头来看 <code>2.in</code>，你会发现在 "<samp>798999</samp>" 后面有一串不明规律的 "<samp>5591928777</samp>"，这是什么意思呢？</p>
		<p>容易发现从这里开始应该是第 $19$ 项 (及以后)，然后可以注意到，如果将其拆分成 <samp>559,1928,777</samp>，则每项的数字之和等于它的项数 (下标)。然后发现这个规律对于前面 $18$ 项也是成立的。</p>
		<p>因此对于 <code>3.in</code>，发现它恰好满足这个规律 <del>(实际上所有的点都满足这个一般性规律)</del>，因此只需写一个程序来边读边算。注意转成 $10$ 进制后要用读入优化版的<em>边读边取模</em>。</p>
		<hr />
		<p>后面这些测试点和前面相比一个显著的区别就是：要求和的项数出奇的大 ($10^{14}$)，因此要求选手寻找隐藏在数列中的规律，而不像前面几个测试点一样所有 $k$ 项都在文件中。</p>
		<p>由于刚才的经验，$a_i$ 满足各位数字和为 $i$，简单验证一下发现对于后面 $7$ 个测试点都是存在拆分方案的。因此以下默认此规律成立。</p>
		<p>先来看<span class="fuchsia-text">第 $7$ 个测试点</span>，即 $a_i$ 为 $i$ 个 $\texttt 1$ 组成的数，那么 $a_i = \sum\limits_{j=0}^{i-1} 10^j = \dfrac {10^i - 1} 9$，前 $n$ 项和</p>
		<p>$$ S_n = \sum_{i=1}^n a_i = \sum_{i=1}^n \frac {10^i - 1} 9 = \frac 19 \cdot \left( \sum_{i=1}^n 10^i - \sum_{i=1}^n 1 \right) = \frac 19 \left( 10 \cdot \frac {10^n - 1} 9 - n \right) = \frac {10^{n+1} - 10 - 9 n} {81} $$</p>
		<p>代入 $n = 10^{14}$ <del>放入 Python</del> 即得结果。</p>
		<p>这里我们可以将 $10$ (基数) 一般化，化为 $x$，可得一个一般性的结果 (会在后面的测试点中用到)：</p>
		<p>$$ 1 + (1 + x) + (1 + x + x^2) + \cdots + (1 + x + x^2 + \cdots + x^{n-1}) = \frac {n - x - n x + x^{n+1}} {(1 - x)^2} $$</p>
		<p>接下来来看<span class="fuchsia-text">第 $4$ 个测试点</span>。看起来可以将它 $9$ 个分为一组，离散的单独算。</p>
		<p>第 $i$ 组为 $\mathtt{99 \cdots 991, 99 \cdots 992, \cdots, 99 \cdots 999}$，为 $i$ 位数 (其中前 $i-1$ 个一定为 $9$)。因此第 $i$ 组中 $9$ 个数的和为 $(10^{i-1} - 1) \cdot 10 \cdot 9 + 45 = 9 \cdot 10^i - 45$，然后对下标 $i$ 求个和即可 (等比数列求和)。</p>
		<p><span class="fuchsia-text">第 $5$ 组数据</span>与第 $4$ 组类似，只是前 $i-1$ 个 $9$ 从前面移到了后面。故第 $i$ 组中 $9$ 个数的和为 $45 \cdot 10^{i-1} + (10^{i-1} - 1) \cdot 9 = 54 \cdot 10^{i-1} - 9$，接下来还是对下标 $i$ 求和。</p>
		<p><span class="fuchsia-text">第 $6$ 个测试点</span>应该可以算得上是最难的测试点了，找找规律可以发现还是 $9$ 个一组。其中第 $i$ 组是把 $9i - 8$ 到 $9i$ 这 $9$ 个数分成尽量均匀的 $i$ 份 (每份不超过 $9$)，然后从小到大拼接得到的数 (比如，第 $3$ 组为 <samp>667,677,777,778,788,888,889,899,999</samp>)。</p>
		<p>初看这好像很难求和的样子，不过到后面可以发现，<strong>自从第 $8$ 组 (第 $64$ 项) 起，数列中的数只有 $8$ 和 $9$</strong>！因为第 $9i$ 项显然是 $i$ 个 $9$，故前面的第 $9i - 8$ 项 (的数字总和) 只比前面的 $i$ 个 $9$ 少了 $8$，故当位数 $\geq 8$ 时，只需将前面的 $8$ 个 $9$ 变成 $8$ 个 $8$ 即可。</p>
		<p>因此前 $63$ 项的和可以打表计算 (和为 $89013231$)，从第 $8$ 组起，每一组的和可以分成前 $8$ 位和后 $n-8$ 位分开计算，故第 $i$ 组的和为 $81234570 \cdot 10^{n-8} + \left( 10^{n-8} - 1 \right) \cdot 9 = 812345679 \cdot 10^{n-8} - 9$，之后还是对下标 $i$ 求和，最后别忘记计算零散的。</p>
		<p><span class="fuchsia-text">第 $8, 9, 10$ 个测试点</span>的规律都比较类似，即给定的串为一个周期串。因此我们可以猜测数列也有周期的规律。<strong>下面仅以第 $9$ 个点作为例子</strong>。</p>
		<p>我们先写出数列的前若干项，发现写完 $15$ 项后指针又回到了起始位置，写长度增加了 $6$，因此我们可以每 $15$ 项作为一列，一列一列地写，如下表 (代码中也有)：</p>
		<pre>     1      1[234321]      1[234321][234321] ...
     2      2[343212]      2[343212][343212] ...
     3      3[432123]      3[432123][432123] ...
     4      4[321234]      4[321234][321234] ...
    32     32[123432]     32[123432][123432] ...
   123    123[432123]    123[432123][432123] ...
    43     43[212343]     43[212343][212343] ...
  2123   2123[432123]   2123[432123][432123] ...
   432    432[123432]    432[123432][123432] ...
  1234   1234[321234]   1234[321234][321234] ...
 32123  32123[432123]  32123[432123][432123] ...
 43212  43212[343212]  43212[321234][321234] ...
 34321  34321[234321]  34321[234321][234321] ...
 23432  23432[123432]  23432[123432][123432] ...
123432 123432[123432] 123432[123432][123432] ...
</pre>
		<p>可以发现，第 $i$ 项与第 $i + 15$ 项之间只差一个后缀 $6$ 位数，且这个 $6$ 位数仅跟 $i \bmod 15$ 的值有关。这引导我们<strong>对每一行分别求和</strong>再相加。</p>
		<p>而对某一行的每个数，我们可以分成两部分，即中括号之前的 "前缀" (prefix)，和中括号内部的 "模式" (pattern)。"前缀" 的求和就是一个简单等比数列；而对 "模式" 来说，比如第一行，除以 $234321$ 后就是 $1 + (1 + x) + (1 + x + x^2) + \cdots$ 的形式 (取 $x = 10^6$)，直接利用上面的公式进行计算即可。</p>
		<p>这里有一个小 trick，关于计算最后零散的数值的。</p>
		<p>比如这道题，周期为 $15$，而题目中给的 $n = 10^{14}$ 并不是 $15$ 的倍数，因此我们需要把最后 $n \bmod 15 = 10$ 个数单独计算。事实上并不用这么麻烦，我们只需先单独计算<strong>前面 $10$ 个数</strong>，然后<strong>后移起点</strong>，把 "前缀" 和一个 "模式" 组成的串定为新的 "前缀"。</p>
		<p>还有更方便的，直接计算出每行出现多少个数，然后代入不同的 $n$ 也是可以的。</p>

		<h3>代码</h3>

		<h4>答案 <del>(虽然我觉得没什么用)</del></h4>
		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">'''</span>
<span class="sh_comment">answers:</span>
<span class="sh_comment">1. 15</span>
<span class="sh_comment">2. 309</span>
<span class="sh_comment">3. 129561340</span>
<span class="sh_comment">4. 243011181</span>
<span class="sh_comment">5. 84904472</span>
<span class="sh_comment">6. 106206872</span>
<span class="sh_comment">7. 826495502</span>
<span class="sh_comment">8. 803703262</span>
<span class="sh_comment">9. 274964514</span>
<span class="sh_comment">10. 902834229</span>
<span class="sh_comment">'''</span>
<span class="sh_keyword">print</span><span class="sh_symbol">([</span><span class="sh_number">15</span><span class="sh_symbol">,</span> <span class="sh_number">309</span><span class="sh_symbol">,</span> <span class="sh_number">129561340</span><span class="sh_symbol">,</span> <span class="sh_number">243011181</span><span class="sh_symbol">,</span> <span class="sh_number">84904472</span><span class="sh_symbol">,</span> <span class="sh_number">106206872</span><span class="sh_symbol">,</span> <span class="sh_number">826495502</span><span class="sh_symbol">,</span> <span class="sh_number">803703262</span><span class="sh_symbol">,</span> <span class="sh_number">274964514</span><span class="sh_symbol">,</span> <span class="sh_number">902834229</span><span class="sh_symbol">][</span><span class="sh_function">int</span><span class="sh_symbol">(</span><span class="sh_function">input</span><span class="sh_symbol">())</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">])</span>

</code></pre></div>

		<h4>Task 3 程序 (以下程序均为 Python 3，下略)</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

s <span class="sh_symbol">=</span> <span class="sh_function">input</span><span class="sh_symbol">()</span>
w<span class="sh_symbol">,</span> v<span class="sh_symbol">,</span> ans <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">0</span>
i <span class="sh_symbol">=</span> <span class="sh_number">1</span>

<span class="sh_keyword">for</span> ch <span class="sh_keyword">in</span> s<span class="sh_symbol">:</span>
    w <span class="sh_symbol">+=</span> ch
    v <span class="sh_symbol">+=</span> <span class="sh_function">int</span><span class="sh_symbol">(</span>ch<span class="sh_symbol">)</span>
    <span class="sh_keyword">if</span> v <span class="sh_symbol">&gt;=</span> i<span class="sh_symbol">:</span>
        ans <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>ans <span class="sh_symbol">+</span> <span class="sh_function">int</span><span class="sh_symbol">(</span>w<span class="sh_symbol">))</span> <span class="sh_symbol">%</span> mod
        w<span class="sh_symbol">,</span> v <span class="sh_symbol">=</span> <span class="sh_string">''</span><span class="sh_symbol">,</span> <span class="sh_number">0</span>
        i <span class="sh_symbol">+=</span> <span class="sh_number">1</span>
        <span class="sh_keyword">if</span> i <span class="sh_symbol">&gt;</span> <span class="sh_number">500</span><span class="sh_symbol">:</span>
            <span class="sh_keyword">break</span>

<span class="sh_keyword">print</span><span class="sh_symbol">(</span>ans<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 4 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">first 9: 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 = 45</span>
<span class="sh_comment">second 9: 91 + 92 + 93 + ... + 99 = 90 * 9 + 45</span>
<span class="sh_comment">third 9: 991 + 992 + 993 + ... + 999 = 990 * 9 + 45</span>
<span class="sh_comment">......</span>
<span class="sh_comment">n-th 9: (10 ^ n - 10) * 9 + 45 = 10 ^ n * 9 - 45</span>

<span class="sh_comment">sum_{i=1}^n (10 ^ i * 9 - 45)</span>
<span class="sh_comment">= 10 * (10 ^ n - 1) / 9 * 9 - 45 n</span>
<span class="sh_comment">= 10 * (10 ^ n - 1) - 45 n</span>
<span class="sh_comment">'''</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">9</span>
G <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
H <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_number">10</span> <span class="sh_symbol">*</span> G <span class="sh_symbol">-</span> <span class="sh_number">45</span> <span class="sh_symbol">*</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod

<span class="sh_comment">'''</span>
<span class="sh_comment">a(9k + 1) = 10 ^ (k + 1) - 9</span>
<span class="sh_comment">'''</span>

I <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">9</span>
<span class="sh_keyword">print</span><span class="sh_symbol">((</span>H <span class="sh_symbol">+</span> I<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 5 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">first 9: 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 = 45</span>
<span class="sh_comment">second 9: 19 + 29 + 39 + ... + 99 = 45 * 10 + 9 * 9</span>
<span class="sh_comment">third 9: 199 + 299 + 399 + ... + 999 = 45 * 100 + 99 * 9</span>
<span class="sh_comment">......</span>
<span class="sh_comment">n-th 9: 45 * 10 ^ (n - 1) + (10 ^ (n - 1) - 1) * 9 = 10 ^ (n - 1) * 54 - 9</span>

<span class="sh_comment">sum_{i=0}^{n-1} (10 ^ i * 54 - 9)</span>
<span class="sh_comment">= (10 ^ n - 1) / 9 * 54 - 9 n</span>
<span class="sh_comment">= 6 * (10 ^ n - 1) - 9 n</span>
<span class="sh_comment">'''</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">9</span>
G <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
H <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_number">6</span> <span class="sh_symbol">*</span> G <span class="sh_symbol">-</span> <span class="sh_number">9</span> <span class="sh_symbol">*</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod

<span class="sh_comment">'''</span>
<span class="sh_comment">a(9k + 1) = 2 * 10 ^ k - 1</span>
<span class="sh_comment">'''</span>

I <span class="sh_symbol">=</span> <span class="sh_number">2</span> <span class="sh_symbol">*</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
<span class="sh_keyword">print</span><span class="sh_symbol">((</span>H <span class="sh_symbol">+</span> I<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 6 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">A bit harder.</span>
<span class="sh_comment">First, we calc the sum of first 63 terms.</span>
<span class="sh_comment">'''</span>

F63 <span class="sh_symbol">=</span> <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">6</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">8</span><span class="sh_symbol">,</span> <span class="sh_number">9</span><span class="sh_symbol">,</span>
    <span class="sh_number">55</span><span class="sh_symbol">,</span> <span class="sh_number">56</span><span class="sh_symbol">,</span> <span class="sh_number">66</span><span class="sh_symbol">,</span> <span class="sh_number">67</span><span class="sh_symbol">,</span> <span class="sh_number">77</span><span class="sh_symbol">,</span> <span class="sh_number">78</span><span class="sh_symbol">,</span> <span class="sh_number">88</span><span class="sh_symbol">,</span> <span class="sh_number">89</span><span class="sh_symbol">,</span> <span class="sh_number">99</span><span class="sh_symbol">,</span>
    <span class="sh_number">667</span><span class="sh_symbol">,</span> <span class="sh_number">677</span><span class="sh_symbol">,</span> <span class="sh_number">777</span><span class="sh_symbol">,</span> <span class="sh_number">778</span><span class="sh_symbol">,</span> <span class="sh_number">788</span><span class="sh_symbol">,</span> <span class="sh_number">888</span><span class="sh_symbol">,</span> <span class="sh_number">889</span><span class="sh_symbol">,</span> <span class="sh_number">899</span><span class="sh_symbol">,</span> <span class="sh_number">999</span><span class="sh_symbol">,</span>
    <span class="sh_number">7777</span><span class="sh_symbol">,</span> <span class="sh_number">7778</span><span class="sh_symbol">,</span> <span class="sh_number">7788</span><span class="sh_symbol">,</span> <span class="sh_number">7888</span><span class="sh_symbol">,</span> <span class="sh_number">8888</span><span class="sh_symbol">,</span> <span class="sh_number">8889</span><span class="sh_symbol">,</span> <span class="sh_number">8899</span><span class="sh_symbol">,</span> <span class="sh_number">8999</span><span class="sh_symbol">,</span> <span class="sh_number">9999</span><span class="sh_symbol">,</span>
    <span class="sh_number">77788</span><span class="sh_symbol">,</span> <span class="sh_number">77888</span><span class="sh_symbol">,</span> <span class="sh_number">78888</span><span class="sh_symbol">,</span> <span class="sh_number">88888</span><span class="sh_symbol">,</span> <span class="sh_number">88889</span><span class="sh_symbol">,</span> <span class="sh_number">88899</span><span class="sh_symbol">,</span> <span class="sh_number">88999</span><span class="sh_symbol">,</span> <span class="sh_number">89999</span><span class="sh_symbol">,</span> <span class="sh_number">99999</span><span class="sh_symbol">,</span>
    <span class="sh_number">778888</span><span class="sh_symbol">,</span> <span class="sh_number">788888</span><span class="sh_symbol">,</span> <span class="sh_number">888888</span><span class="sh_symbol">,</span> <span class="sh_number">888889</span><span class="sh_symbol">,</span> <span class="sh_number">888899</span><span class="sh_symbol">,</span> <span class="sh_number">888999</span><span class="sh_symbol">,</span> <span class="sh_number">889999</span><span class="sh_symbol">,</span> <span class="sh_number">899999</span><span class="sh_symbol">,</span> <span class="sh_number">999999</span><span class="sh_symbol">,</span>
    <span class="sh_number">7888888</span><span class="sh_symbol">,</span> <span class="sh_number">8888888</span><span class="sh_symbol">,</span> <span class="sh_number">8888889</span><span class="sh_symbol">,</span> <span class="sh_number">8888899</span><span class="sh_symbol">,</span> <span class="sh_number">8888999</span><span class="sh_symbol">,</span> <span class="sh_number">8889999</span><span class="sh_symbol">,</span> <span class="sh_number">8899999</span><span class="sh_symbol">,</span> <span class="sh_number">8999999</span><span class="sh_symbol">,</span> <span class="sh_number">9999999</span><span class="sh_symbol">]</span>
A <span class="sh_symbol">=</span> <span class="sh_function">sum</span><span class="sh_symbol">(</span>F63<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">From 64th terms on, the sequence go like this:</span>

<span class="sh_comment">888888889...9, 888888899...9, 888888999...9, 888889999...9, 888899999...9, 888999999...9, 889999999...9, 899999999...9, 999999999...9,</span>

<span class="sh_comment">Consider the n-th 9 (n &gt;= 8), the sum:</span>
<span class="sh_comment">    123456789...n</span>
<span class="sh_comment">    |||||||||   |</span>
<span class="sh_comment">    888888889...9</span>
<span class="sh_comment">    888888899...9</span>
<span class="sh_comment">    888888999...9</span>
<span class="sh_comment">    888889999...9</span>
<span class="sh_comment">    888899999...9</span>
<span class="sh_comment">    888999999...9</span>
<span class="sh_comment">    889999999...9</span>
<span class="sh_comment">    899999999...9</span>
<span class="sh_comment">    999999999...9</span>
<span class="sh_comment">is equal to 812345670 * 10 ^ (n - 8) + 9 * (10 ^ (n - 8) - 1)</span>
<span class="sh_comment">= 812345679 * 10 ^ (n - 8) - 9.</span>

<span class="sh_comment">So, answer is</span>
<span class="sh_comment">sum_{i=0}^{n-8} (812345679 * 10 ^ i - 9)</span>
<span class="sh_comment">= 812345679 * (10 ^ (n - 7) - 1) / 9 - 9 * (n - 7)</span>
<span class="sh_comment">'''</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">9</span>
B <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n <span class="sh_symbol">-</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
C <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_number">90260631</span> <span class="sh_symbol">*</span> B <span class="sh_symbol">-</span> <span class="sh_number">9</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>n <span class="sh_symbol">-</span> <span class="sh_number">7</span><span class="sh_symbol">))</span> <span class="sh_symbol">%</span> mod

<span class="sh_comment">'''</span>
<span class="sh_comment">And the last term, a(9k + 1),</span>
<span class="sh_comment">= 8 8 8 8 8 8 8 8 9 ... 9</span>
<span class="sh_comment">                  |     |</span>
<span class="sh_comment">                  -------</span>
<span class="sh_comment">                     |</span>
<span class="sh_comment">                   k - 7</span>
<span class="sh_comment">is equal to 88888889 * 10 ^ (k - 7) - 1</span>
<span class="sh_comment">'''</span>

D <span class="sh_symbol">=</span> <span class="sh_number">88888889</span> <span class="sh_symbol">*</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n <span class="sh_symbol">-</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
<span class="sh_keyword">print</span><span class="sh_symbol">((</span>A <span class="sh_symbol">+</span> C <span class="sh_symbol">+</span> D<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 7 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">Quite easy.</span>
<span class="sh_comment">sum_{i=1}^n (10 ^ i - 1) / 9</span>
<span class="sh_comment">= (10 * (10 ^ n - 1) / 9 - n) / 9</span>
<span class="sh_comment">= (10 ^ (n + 1) - 10 - 9 n) / 81</span>
<span class="sh_comment">'''</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span>
A <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">10</span><span class="sh_symbol">,</span> n <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">10</span> <span class="sh_symbol">-</span> <span class="sh_number">9</span> <span class="sh_symbol">*</span> n
<span class="sh_keyword">print</span><span class="sh_symbol">(</span>A <span class="sh_symbol">*</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span><span class="sh_number">81</span><span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 8 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">It becomes harder.</span>

<span class="sh_comment">Find the pattern first.</span>
<span class="sh_comment">     1</span>
<span class="sh_comment">     2</span>
<span class="sh_comment">    12</span>
<span class="sh_comment">   121</span>
<span class="sh_comment">   212</span>
<span class="sh_comment">  1212</span>
<span class="sh_comment"> 12121</span>
<span class="sh_comment"> 21212</span>
<span class="sh_comment">121212</span>
<span class="sh_comment">......</span>

<span class="sh_comment">Every 3 term, the sum is:</span>
<span class="sh_comment">    15</span>
<span class="sh_comment">  1545</span>
<span class="sh_comment">154545</span>
<span class="sh_comment">......</span>

<span class="sh_comment">a(n) = u * 100 ^ n + v, where u = 17/110, v = -5/11</span>

<span class="sh_comment">a(1) + a(2) + ... + a(n) = u * 100 (100 ^ n - 1) / 99 + v n</span>

<span class="sh_comment">a(3k + 1) = (100 ^ k - 1) / 99 * 120 + 1</span>
<span class="sh_comment">'''</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">3</span>
u <span class="sh_symbol">=</span> <span class="sh_number">17</span> <span class="sh_symbol">*</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span><span class="sh_number">110</span><span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod
v <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">5</span> <span class="sh_symbol">*</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span><span class="sh_number">11</span><span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod
A <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span><span class="sh_number">100</span><span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
B <span class="sh_symbol">=</span> u <span class="sh_symbol">*</span> <span class="sh_number">100</span> <span class="sh_symbol">*</span> A <span class="sh_symbol">*</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span><span class="sh_number">99</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> v <span class="sh_symbol">*</span> n
C <span class="sh_symbol">=</span> A <span class="sh_symbol">*</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span><span class="sh_number">99</span><span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_number">120</span> <span class="sh_symbol">+</span> <span class="sh_number">1</span>
<span class="sh_keyword">print</span><span class="sh_symbol">((</span>B <span class="sh_symbol">+</span> C<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 9 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">More difficult.</span>

<span class="sh_comment">Find the pattern first.</span>
<span class="sh_comment">     1      1[234321]      1[234321][234321] ...</span>
<span class="sh_comment">     2      2[343212]      2[343212][343212] ...</span>
<span class="sh_comment">     3      3[432123]      3[432123][432123] ...</span>
<span class="sh_comment">     4      4[321234]      4[321234][321234] ...</span>
<span class="sh_comment">    32     32[123432]     32[123432][123432] ...</span>
<span class="sh_comment">   123    123[432123]    123[432123][432123] ...</span>
<span class="sh_comment">    43     43[212343]     43[212343][212343] ...</span>
<span class="sh_comment">  2123   2123[432123]   2123[432123][432123] ...</span>
<span class="sh_comment">   432    432[123432]    432[123432][123432] ...</span>
<span class="sh_comment">  1234   1234[321234]   1234[321234][321234] ...</span>
<span class="sh_comment"> 32123  32123[432123]  32123[432123][432123] ...</span>
<span class="sh_comment"> 43212  43212[343212]  43212[321234][321234] ...</span>
<span class="sh_comment"> 34321  34321[234321]  34321[234321][234321] ...</span>
<span class="sh_comment"> 23432  23432[123432]  23432[123432][123432] ...</span>
<span class="sh_comment">123432 123432[123432] 123432[123432][123432] ...</span>

<span class="sh_comment">We can write a function to simplify the summations.</span>

<span class="sh_comment">f(a, b, n, x) = a + a[b] + a[b][b] + ... + a[b]...[b] (all n-1 [b])</span>
<span class="sh_comment">'''</span>

<span class="sh_keyword">def</span> <span class="sh_function">f</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> b<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> x <span class="sh_symbol">=</span> <span class="sh_number">1000000</span><span class="sh_symbol">):</span>
    I <span class="sh_symbol">=</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span>
    A <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
    A <span class="sh_symbol">=</span> A <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> a
    B <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> x <span class="sh_symbol">-</span> <span class="sh_symbol">(</span>x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>n <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span>
    B <span class="sh_symbol">=</span> B <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> b
    <span class="sh_keyword">return</span> <span class="sh_symbol">(</span>A <span class="sh_symbol">+</span> B<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod

<span class="sh_comment">'''</span>
<span class="sh_comment">let first 10 terms alone, so answer is</span>
<span class="sh_comment">&lt;First 10 Terms&gt; + f(32123, 432123, n) + f(43212, 343212, n) + ... + f(1234321234, 321234, n)</span>
<span class="sh_comment">'''</span>

F10 <span class="sh_symbol">=</span> <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_number">32</span><span class="sh_symbol">,</span> <span class="sh_number">123</span><span class="sh_symbol">,</span> <span class="sh_number">43</span><span class="sh_symbol">,</span> <span class="sh_number">2123</span><span class="sh_symbol">,</span> <span class="sh_number">432</span><span class="sh_symbol">,</span> <span class="sh_number">1234</span><span class="sh_symbol">]</span>
A <span class="sh_symbol">=</span> <span class="sh_function">sum</span><span class="sh_symbol">(</span>F10<span class="sh_symbol">)</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">15</span>
B <span class="sh_symbol">=</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">32123</span><span class="sh_symbol">,</span> <span class="sh_number">432123</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">43212</span><span class="sh_symbol">,</span> <span class="sh_number">343212</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">34321</span><span class="sh_symbol">,</span> <span class="sh_number">234321</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">23432</span><span class="sh_symbol">,</span> <span class="sh_number">123432</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">123432</span><span class="sh_symbol">,</span> <span class="sh_number">123432</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">1234321</span><span class="sh_symbol">,</span> <span class="sh_number">234321</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">2343212</span><span class="sh_symbol">,</span> <span class="sh_number">343212</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">3432123</span><span class="sh_symbol">,</span> <span class="sh_number">432123</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">4321234</span><span class="sh_symbol">,</span> <span class="sh_number">321234</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">32123432</span><span class="sh_symbol">,</span> <span class="sh_number">123432</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">123432123</span><span class="sh_symbol">,</span> <span class="sh_number">432123</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">43212343</span><span class="sh_symbol">,</span> <span class="sh_number">212343</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">2123432123</span><span class="sh_symbol">,</span> <span class="sh_number">432123</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">432123432</span><span class="sh_symbol">,</span> <span class="sh_number">123432</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">1234321234</span><span class="sh_symbol">,</span> <span class="sh_number">321234</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>

<span class="sh_keyword">print</span><span class="sh_symbol">((</span>A <span class="sh_symbol">+</span> B<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>

		<h4>Task 10 程序</h4>

		<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_python"><span class="sh_comment">#!/usr/bin/env python3</span>

mod <span class="sh_symbol">=</span> <span class="sh_number">1000000123</span>

<span class="sh_keyword">def</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x<span class="sh_symbol">):</span>
    <span class="sh_keyword">return</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> mod <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span>

<span class="sh_comment">'''</span>
<span class="sh_comment">Ultimate battle !</span>

<span class="sh_comment">Find the pattern first.</span>
<span class="sh_comment">      1       1[1132231] ...</span>
<span class="sh_comment">     11      11[3223111] ...</span>
<span class="sh_comment">      3       3[2231113] ...</span>
<span class="sh_comment">     22      22[3111322] ...</span>
<span class="sh_comment">    311     311[1322311] ...</span>
<span class="sh_comment">    132     132[2311132] ...</span>
<span class="sh_comment">   2311    2311[1322311] ...</span>
<span class="sh_comment">   1322    1322[3111322] ...</span>
<span class="sh_comment">  31113   31113[2231113] ...</span>
<span class="sh_comment"> 223111  223111[3223111] ...</span>
<span class="sh_comment">  32231   32231[1132231] ...</span>
<span class="sh_comment"> 113223  113223[1113223] ...</span>
<span class="sh_comment">1113223 1113223[1113223] ...</span>

<span class="sh_comment">It is similar to 'Task #9' in fact.</span>
<span class="sh_comment">'''</span>

<span class="sh_keyword">def</span> <span class="sh_function">f</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> b<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> x <span class="sh_symbol">=</span> <span class="sh_number">10000000</span><span class="sh_symbol">):</span>
    I <span class="sh_symbol">=</span> <span class="sh_function">inv</span><span class="sh_symbol">(</span>x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span>
    A <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> <span class="sh_number">1</span>
    A <span class="sh_symbol">=</span> A <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> a
    B <span class="sh_symbol">=</span> <span class="sh_function">pow</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">-</span> x <span class="sh_symbol">-</span> <span class="sh_symbol">(</span>x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>n <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span>
    B <span class="sh_symbol">=</span> B <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> I <span class="sh_symbol">*</span> b
    <span class="sh_keyword">return</span> <span class="sh_symbol">(</span>A <span class="sh_symbol">+</span> B<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod

F9 <span class="sh_symbol">=</span> <span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">11</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">22</span><span class="sh_symbol">,</span> <span class="sh_number">311</span><span class="sh_symbol">,</span> <span class="sh_number">132</span><span class="sh_symbol">,</span> <span class="sh_number">2311</span><span class="sh_symbol">,</span> <span class="sh_number">1322</span><span class="sh_symbol">,</span> <span class="sh_number">31113</span><span class="sh_symbol">]</span>
A <span class="sh_symbol">=</span> <span class="sh_function">sum</span><span class="sh_symbol">(</span>F9<span class="sh_symbol">)</span>

n <span class="sh_symbol">=</span> <span class="sh_number">10</span> <span class="sh_symbol">**</span> <span class="sh_number">14</span> <span class="sh_symbol">//</span> <span class="sh_number">13</span>
B <span class="sh_symbol">=</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">223111</span><span class="sh_symbol">,</span> <span class="sh_number">3223111</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">32231</span><span class="sh_symbol">,</span> <span class="sh_number">1132231</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">113223</span><span class="sh_symbol">,</span> <span class="sh_number">1113223</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">1113223</span><span class="sh_symbol">,</span> <span class="sh_number">1113223</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">11132231</span><span class="sh_symbol">,</span> <span class="sh_number">1132231</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">113223111</span><span class="sh_symbol">,</span> <span class="sh_number">3223111</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">32231113</span><span class="sh_symbol">,</span> <span class="sh_number">2231113</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">223111322</span><span class="sh_symbol">,</span> <span class="sh_number">3111322</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">3111322311</span><span class="sh_symbol">,</span> <span class="sh_number">1322311</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">1322311132</span><span class="sh_symbol">,</span> <span class="sh_number">2311132</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">23111322311</span><span class="sh_symbol">,</span> <span class="sh_number">1322311</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">13223111322</span><span class="sh_symbol">,</span> <span class="sh_number">3111322</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>
  <span class="sh_symbol">+</span> <span class="sh_function">f</span><span class="sh_symbol">(</span><span class="sh_number">311132231113</span><span class="sh_symbol">,</span> <span class="sh_number">2231113</span><span class="sh_symbol">,</span> n<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>

<span class="sh_keyword">print</span><span class="sh_symbol">((</span>A <span class="sh_symbol">+</span> B<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span>

</code></pre></div>
	</body>
</html>
