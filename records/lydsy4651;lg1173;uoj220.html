<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>跳蚤国王和蛐蛐国王在玩一个游戏。</p>
<p>她们在一个 $n$ 行 $m$ 列的网格上排兵布阵。其中的 $c$ 个格子中 $(0 \leq c \leq nm)$，每个格子有一只蛐蛐，其余的格子中，每个格子有一只跳蚤。</p>
<p><strong>除特殊说明外，以下称两个格子是连通的，均指四连通。</strong></p>
<p>现在，蛐蛐国王希望，将某些 ($0$ 个，$1$ 个或多个) 跳蚤替换成蛐蛐，使得在此之后存在至少两只跳蚤<strong>不连通</strong>。</p>
<p>例如：我们用图 <img src="http://img.uoj.ac/problem/220/flea.png" /> 表示一只跳蚤，用图 <img src="http://img.uoj.ac/problem/220/cricket.png" /> 表示一只蛐蛐，那么图 1 描述了一个 $n = 4, m = 4, c = 2$ 的情况。</p>
<p>这种情况下蛐蛐国王可以通过将第 $2$ 行第 $2$ 列，和第 $3$ 行第 $3$ 列的两只跳蚤替换为蛐蛐，从而达成他的希望，如图 2 所示。并且，不存在更优的方案，但是可能存在其他替换 $2$ 只跳蚤的方案。</p>
<p><img src="http://img.uoj.ac/problem/220/img1.png" /> 图1 <img src="http://img.uoj.ac/problem/220/img2.png" /> 图2</p>
<p>你需要首先判断蛐蛐国王的希望能否被达成。如果能够达成，你还需要最小化被替换的跳蚤的个数。</p>

<h3>输入格式</h3>
<p>每个输入文件包含多组数据。</p>
<p>输入文件的第一行只有一个整数 $T$，表示数据的组数。保证 $1 \leq T \leq 20$。</p>
<p>接下来依次输入 $T$ 组数据，每组数据的第一行包含三个整数 $n, m, c$。保证$1 \leq n, m \leq 10^9, 0 \leq c \leq \min\{nm, 10^5\}$。</p>
<p>接下来 $c$ 行，每行包含两个整数 $x, y$，表示第 $x$ 行，第 $y$ 列的格子被一个蛐蛐占据 ($1 \leq x \leq n, 1 \leq y \leq m$)。每一组数据当中，同一个蛐蛐不会被多次描述。</p>
<p>同一行相邻的整数之间由一个空格隔开。</p>

<h3>输出格式</h3>
<p>对于每一组数据依次输出一行答案。</p>
<p>如果这组数据中，蛐蛐国王的希望不能被达成，输出 <code>−1</code>。否则，输出被替换的跳蚤的个数的最小值。</p>

<h3>题解</h3>
<p><del>NOI 2016 神题……</del></p>
<p>首先可以发现答案一定为 $-1, 0, 1, 2$ 中的一个。</p>
<p>以下称含有 <img src="http://img.uoj.ac/problem/220/flea.png" /> 的格子为空地。</p>
<p>假如说用 $n$ ($n \geq 3$) 个 <img src="http://img.uoj.ac/problem/220/cricket.png" /> 使原来连通的空地不连通，则原空地存在一个角 (其实空地连通块中最上面一行的最左端一个就是角)，而将这个角与其它格子不连通<strong>至多</strong>需要 $2$ 个 <img src="http://img.uoj.ac/problem/220/cricket.png" />。</p>
<p>先来考虑 $-1$ 的情况，如果网格中只有 $1$ 个空地或 $2$ 个相邻的空地，则无论如何，也搞不出两块不连通的空地，这个可以轻松特判。</p>
<p>再来考虑 $0$ 的情况，说明原来已经存在不连通的空地，<code>dfs()</code> 一下即可。</p>
<p>(scx: 然而这张图的点数有点多啊！)</p>
<p>虽然点数有点多，但是 (当点数巨大时) <img src="http://img.uoj.ac/problem/220/cricket.png" /> 的数量是远小于空地的数量的，因此存在很多无用的空地。</p>
<p>因此可以证明，判 $0$ 的时候，只需要把与其中一只 <img src="http://img.uoj.ac/problem/220/cricket.png" /> <strong>8 - 相邻</strong>的所有空地拿出来，按照 <strong>4 - 相邻</strong>建图判断连通性即可。</p>
<hr />
<p>然后就是判 $1$，其实，如果存在一个空地，把它换成 <img src="http://img.uoj.ac/problem/220/cricket.png" /> 后存在不连通的空地，就相当于把所有的空地按照连通性建图后，<strong>存在割点</strong>。</p>
<p>由于点数比较多，所以还是要采取压缩 (和离散化的思想有点像) 算法。</p>
<p>按照官方题解的说法，我们称与 <img src="http://img.uoj.ac/problem/220/cricket.png" /> <strong>8 - 相邻</strong>的空地称为<strong>一级空地</strong>，(不是空地且) 与一级空地 <strong>8 - 相邻</strong>的空地称为<strong>二级空地</strong>。</p>
<p>可以看出，如果一个空地为割点，则它一定是<strong>一级空地</strong>。</p>
<p>因此可以考虑对所有一级空地按照 <strong>4 - 相邻</strong>建图后，用 Tarjan 算法判断是否存在割点。</p>
<p>然而这个是错的，其实是存在反例的，如下图：</p>
<p><img src="https://cdn.vijos.org/fs/bab0cef58715d7cfb50fa96f679be10390de6265" /></p>
<p>可以看出，所有的圈均为一级空地，而橙圈就是割点，然而它<strong>不是</strong>原图的割点。</p>
<p>因此，我们需要把所有一级空地和二级空地均按照 <strong>4 - 相邻</strong>建图后，此时的 (一级空地的) 割点，就<strong>一定</strong>是原图的割点啦，具体证明可以看一下官方题解，<del>不过可以意会一下</del>。</p>
<p>于是时间复杂度就变成了 $O(Tc\log c)$，可以考虑判断坐标是否出现不用二分和 <code>set</code>，而用 Hash 表或 Hash Map，可以将平均时间复杂度降为 $O(Tc)$，具体要看你的 Hash 函数和 Hash 表的大小了。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">100034</span>
<span class="sh_preproc">#define</span> maxV <span class="sh_number">2561010</span>
<span class="sh_preproc">#define</span> maxE <span class="sh_number">7683030</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> ll<span class="sh_symbol">;</span>

<span class="sh_keyword">const</span> <span class="sh_type">int</span> dr<span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_keyword">const</span> <span class="sh_type">int</span> dc<span class="sh_symbol">[</span><span class="sh_number">4</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">class</span><span class="sh_normal"> </span><span class="sh_classname">hash_map</span><span class="sh_cbracket">{</span>
<span class="sh_keyword">public</span><span class="sh_symbol">:</span>
    <span class="sh_keyword">struct</span><span class="sh_normal"> </span><span class="sh_classname">data</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> r<span class="sh_symbol">,</span> c<span class="sh_symbol">,</span> v<span class="sh_symbol">,</span> hash<span class="sh_symbol">;</span>
        <span class="sh_function">data</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> r0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_type">int</span> c0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_type">int</span> v0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_type">int</span> hash0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">):</span> <span class="sh_function">r</span><span class="sh_symbol">(</span>r0<span class="sh_symbol">),</span> <span class="sh_function">c</span><span class="sh_symbol">(</span>c0<span class="sh_symbol">),</span> <span class="sh_function">v</span><span class="sh_symbol">(</span>v0<span class="sh_symbol">),</span> <span class="sh_function">hash</span><span class="sh_symbol">(</span>hash0<span class="sh_symbol">)</span> <span class="sh_cbracket">{}</span>
    <span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">typedef</span> <span class="sh_usertype">data</span><span class="sh_normal"> </span><span class="sh_symbol">*</span>iterator<span class="sh_symbol">;</span>
<span class="sh_keyword">private</span><span class="sh_symbol">:</span>
    <span class="sh_keyword">static</span> <span class="sh_keyword">const</span> <span class="sh_usertype">ll</span><span class="sh_normal"> </span>HASH_MAX <span class="sh_symbol">=</span> <span class="sh_number">0x3fffff</span><span class="sh_symbol">;</span>
    <span class="sh_type">int</span> cnt<span class="sh_symbol">,</span> first<span class="sh_symbol">[</span>HASH_MAX <span class="sh_symbol">+</span> <span class="sh_number">2</span><span class="sh_symbol">],</span> next<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span> <span class="sh_usertype">data</span><span class="sh_normal"> </span>z<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>
    <span class="sh_type">int</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span><span class="sh_type">int</span> r0<span class="sh_symbol">,</span> <span class="sh_type">int</span> c0<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_usertype">ll</span><span class="sh_normal"> </span>M <span class="sh_symbol">=</span> <span class="sh_number">0x29aee</span> <span class="sh_symbol">*</span> r0 <span class="sh_symbol">+</span> c0<span class="sh_symbol">;</span>
        <span class="sh_keyword">return</span> <span class="sh_symbol">(</span><span class="sh_type">int</span><span class="sh_symbol">)(</span>M <span class="sh_symbol">&amp;</span> HASH_MAX<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
<span class="sh_keyword">public</span><span class="sh_symbol">:</span>
    <span class="sh_type">void</span> <span class="sh_function">resize</span><span class="sh_symbol">(</span><span class="sh_type">int</span> R <span class="sh_symbol">=</span> <span class="sh_number">4</span><span class="sh_symbol">,</span> <span class="sh_type">int</span> C <span class="sh_symbol">=</span> <span class="sh_number">4</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span><span class="sh_keyword">for</span><span class="sh_symbol">(;</span> cnt <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_symbol">--</span>cnt<span class="sh_symbol">)</span> first<span class="sh_symbol">[</span>z<span class="sh_symbol">[</span>cnt<span class="sh_symbol">].</span>hash<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> z<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">data</span><span class="sh_symbol">(</span>R<span class="sh_symbol">,</span> C<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_usertype">iterator</span><span class="sh_normal"> </span><span class="sh_function">find</span><span class="sh_symbol">(</span><span class="sh_type">int</span> r0<span class="sh_symbol">,</span> <span class="sh_type">int</span> c0<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> x <span class="sh_symbol">=</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span>r0<span class="sh_symbol">,</span> c0<span class="sh_symbol">),</span> i<span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>r <span class="sh_symbol">==</span> r0 <span class="sh_symbol">&amp;&amp;</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>c <span class="sh_symbol">==</span> c0<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> z <span class="sh_symbol">+</span> i<span class="sh_symbol">;</span>
        <span class="sh_keyword">return</span> <span class="sh_symbol">(</span>iterator<span class="sh_symbol">)</span>NULL<span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_type">bool</span> <span class="sh_function">insert</span><span class="sh_symbol">(</span><span class="sh_type">int</span> r0<span class="sh_symbol">,</span> <span class="sh_type">int</span> c0<span class="sh_symbol">,</span> <span class="sh_type">int</span> v0<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> x <span class="sh_symbol">=</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span>r0<span class="sh_symbol">,</span> c0<span class="sh_symbol">),</span> i<span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>r <span class="sh_symbol">==</span> r0 <span class="sh_symbol">&amp;&amp;</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>c <span class="sh_symbol">==</span> c0<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
        z<span class="sh_symbol">[++</span>cnt<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">data</span><span class="sh_symbol">(</span>r0<span class="sh_symbol">,</span> c0<span class="sh_symbol">,</span> v0<span class="sh_symbol">,</span> x<span class="sh_symbol">);</span>
        next<span class="sh_symbol">[</span>cnt<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> cnt<span class="sh_symbol">;</span> <span class="sh_keyword">return</span> z <span class="sh_symbol">+</span> cnt<span class="sh_symbol">;</span>
        <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">iterator</span><span class="sh_normal"> </span><span class="sh_function">begin</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span><span class="sh_keyword">return</span> z <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">iterator</span><span class="sh_normal"> </span><span class="sh_function">end</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span><span class="sh_keyword">return</span> z <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>cnt <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">namespace</span> Graph<span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> V<span class="sh_symbol">,</span> E<span class="sh_symbol">,</span> to<span class="sh_symbol">[</span>maxV<span class="sh_symbol">],</span> first<span class="sh_symbol">[</span>maxV<span class="sh_symbol">],</span> next<span class="sh_symbol">[</span>maxE<span class="sh_symbol">];</span>
    <span class="sh_type">int</span> id<span class="sh_symbol">[</span>N<span class="sh_symbol">],</span> low<span class="sh_symbol">[</span>N<span class="sh_symbol">],</span> cnt<span class="sh_symbol">;</span>
    <span class="sh_type">int</span> connected_component_count<span class="sh_symbol">,</span> cut_point_existence<span class="sh_symbol">;</span>
    <span class="sh_type">bool</span> is_second<span class="sh_symbol">[</span>maxV<span class="sh_symbol">];</span>
    <span class="sh_type">void</span> <span class="sh_function">reset</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span><span class="sh_keyword">for</span><span class="sh_symbol">(</span>E <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> V <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_symbol">--</span>V<span class="sh_symbol">)</span> is_second<span class="sh_symbol">[</span>V<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> id<span class="sh_symbol">[</span>V<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>V<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">addedge</span><span class="sh_symbol">(</span><span class="sh_type">int</span> u<span class="sh_symbol">,</span> <span class="sh_type">int</span> v<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>to<span class="sh_symbol">[++</span>E<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> v<span class="sh_symbol">;</span> next<span class="sh_symbol">[</span>E<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>u<span class="sh_symbol">];</span> first<span class="sh_symbol">[</span>u<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> E<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">set_second</span><span class="sh_symbol">(</span><span class="sh_type">int</span> id<span class="sh_symbol">,</span> <span class="sh_type">bool</span> second <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span>is_second<span class="sh_symbol">[</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_type">void</span> <span class="sh_function">dfs</span><span class="sh_symbol">(</span><span class="sh_type">int</span> x<span class="sh_symbol">,</span> <span class="sh_type">int</span> px<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_type">int</span> i<span class="sh_symbol">,</span> y<span class="sh_symbol">,</span> M <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        id<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> low<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">++</span>cnt<span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span> i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">((</span>y <span class="sh_symbol">=</span> to<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_symbol">!=</span> px<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>id<span class="sh_symbol">[</span>y<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
                    <span class="sh_symbol">++</span>M<span class="sh_symbol">;</span>
                    <span class="sh_function">dfs</span><span class="sh_symbol">(</span>y<span class="sh_symbol">,</span> x<span class="sh_symbol">);</span>
                    low<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">min</span><span class="sh_symbol">(</span>low<span class="sh_symbol">[</span>x<span class="sh_symbol">],</span> low<span class="sh_symbol">[</span>y<span class="sh_symbol">]);</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>is_second<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> id<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;=</span> low<span class="sh_symbol">[</span>y<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_symbol">~</span>px<span class="sh_symbol">)</span> cut_point_existence <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
                <span class="sh_cbracket">}</span><span class="sh_keyword">else</span> <span class="sh_comment">// cycle</span>
                    low<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">min</span><span class="sh_symbol">(</span>low<span class="sh_symbol">[</span>x<span class="sh_symbol">],</span> id<span class="sh_symbol">[</span>y<span class="sh_symbol">]);</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>is_second<span class="sh_symbol">[</span>x<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> px <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span> <span class="sh_symbol">&amp;&amp;</span> M <span class="sh_symbol">&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> cut_point_existence <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_type">void</span> <span class="sh_function">tarjan</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
        connected_component_count <span class="sh_symbol">=</span> cut_point_existence <span class="sh_symbol">=</span> cnt <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> V<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>id<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
                <span class="sh_symbol">++</span>connected_component_count<span class="sh_symbol">;</span>
                <span class="sh_function">dfs</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">);</span>
            <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_type">int</span> r<span class="sh_symbol">,</span> c<span class="sh_symbol">,</span> n<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">;</span>
<span class="sh_type">int</span> x<span class="sh_symbol">[</span>N<span class="sh_symbol">],</span> y<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>
<span class="sh_type">bool</span> used<span class="sh_symbol">[</span>N<span class="sh_symbol">],</span> flag<span class="sh_symbol">;</span>
<span class="sh_type">int</span> que<span class="sh_symbol">[</span>maxV<span class="sh_symbol">],</span> h<span class="sh_symbol">,</span> t<span class="sh_symbol">;</span>
<span class="sh_usertype">hash_map</span><span class="sh_normal"> </span>m<span class="sh_symbol">,</span> q<span class="sh_symbol">;</span>

<span class="sh_type">void</span> <span class="sh_function">bfs</span><span class="sh_symbol">(</span><span class="sh_type">int</span> id<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">,</span> d<span class="sh_symbol">,</span> r0<span class="sh_symbol">,</span> c0<span class="sh_symbol">;</span>
    hash_map<span class="sh_symbol">::</span><span class="sh_usertype">iterator</span><span class="sh_normal"> </span>it<span class="sh_symbol">;</span>
    que<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> id<span class="sh_symbol">;</span> t <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>h <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> h <span class="sh_symbol">&lt;</span> t<span class="sh_symbol">;</span> h<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
        id <span class="sh_symbol">=</span> que<span class="sh_symbol">[</span>h<span class="sh_symbol">];</span> r0 <span class="sh_symbol">=</span> x<span class="sh_symbol">[</span>id<span class="sh_symbol">];</span> c0 <span class="sh_symbol">=</span> y<span class="sh_symbol">[</span>id<span class="sh_symbol">];</span> used<span class="sh_symbol">[</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> r0 <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> i <span class="sh_symbol">&lt;=</span> r0 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">&amp;&amp;</span> i <span class="sh_symbol">&lt;=</span> r<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> c0 <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> j <span class="sh_symbol">&lt;=</span> c0 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">&amp;&amp;</span> j <span class="sh_symbol">&lt;=</span> c<span class="sh_symbol">;</span> j<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">==</span> r0 <span class="sh_symbol">&amp;&amp;</span> j <span class="sh_symbol">==</span> c0<span class="sh_symbol">)</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">((</span>it <span class="sh_symbol">=</span> m<span class="sh_symbol">.</span><span class="sh_function">find</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> j<span class="sh_symbol">))</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_symbol">!</span>used<span class="sh_symbol">[</span>it<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
                    que<span class="sh_symbol">[</span>t<span class="sh_symbol">++]</span> <span class="sh_symbol">=</span> it<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">;</span> used<span class="sh_symbol">[</span>it<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
                <span class="sh_cbracket">}</span>
            <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    q<span class="sh_symbol">.</span><span class="sh_function">resize</span><span class="sh_symbol">(</span>r<span class="sh_symbol">,</span> c<span class="sh_symbol">);</span>
    Graph<span class="sh_symbol">::</span><span class="sh_function">reset</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>h <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> h <span class="sh_symbol">&lt;</span> t<span class="sh_symbol">;</span> h<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
        id <span class="sh_symbol">=</span> que<span class="sh_symbol">[</span>h<span class="sh_symbol">];</span> r0 <span class="sh_symbol">=</span> x<span class="sh_symbol">[</span>id<span class="sh_symbol">];</span> c0 <span class="sh_symbol">=</span> y<span class="sh_symbol">[</span>id<span class="sh_symbol">];</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> r0 <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> i <span class="sh_symbol">&lt;=</span> r0 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">&amp;&amp;</span> i <span class="sh_symbol">&lt;=</span> r<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span> c0 <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">);</span> j <span class="sh_symbol">&lt;=</span> c0 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">&amp;&amp;</span> j <span class="sh_symbol">&lt;=</span> c<span class="sh_symbol">;</span> j<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">==</span> r0 <span class="sh_symbol">&amp;&amp;</span> j <span class="sh_symbol">==</span> c0<span class="sh_symbol">)</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>m<span class="sh_symbol">.</span><span class="sh_function">find</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> j<span class="sh_symbol">))</span><span class="sh_cbracket">{</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(!(</span>q<span class="sh_symbol">.</span><span class="sh_function">insert</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> <span class="sh_symbol">++</span>Graph<span class="sh_symbol">::</span>V<span class="sh_symbol">)))</span> <span class="sh_symbol">--</span>Graph<span class="sh_symbol">::</span>V<span class="sh_symbol">;</span>
                <span class="sh_cbracket">}</span>
            <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">build_graph</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    hash_map<span class="sh_symbol">::</span><span class="sh_usertype">iterator</span><span class="sh_normal"> </span>it<span class="sh_symbol">,</span> jt<span class="sh_symbol">;</span>
    <span class="sh_type">int</span> d<span class="sh_symbol">,</span> r0<span class="sh_symbol">,</span> c0<span class="sh_symbol">,</span> r1<span class="sh_symbol">,</span> c1<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>it <span class="sh_symbol">=</span> q<span class="sh_symbol">.</span><span class="sh_function">begin</span><span class="sh_symbol">();</span> it <span class="sh_symbol">!=</span> q<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">();</span> <span class="sh_symbol">++</span>it<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        r0 <span class="sh_symbol">=</span> it<span class="sh_symbol">-&gt;</span>r<span class="sh_symbol">;</span> c0 <span class="sh_symbol">=</span> it<span class="sh_symbol">-&gt;</span>c<span class="sh_symbol">;</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>d <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> d <span class="sh_symbol">&lt;</span> <span class="sh_number">4</span><span class="sh_symbol">;</span> d<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
            r1 <span class="sh_symbol">=</span> r0 <span class="sh_symbol">+</span> dr<span class="sh_symbol">[</span>d<span class="sh_symbol">];</span> c1 <span class="sh_symbol">=</span> c0 <span class="sh_symbol">+</span> dc<span class="sh_symbol">[</span>d<span class="sh_symbol">];</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>r1 <span class="sh_symbol">&lt;=</span> <span class="sh_number">0</span> <span class="sh_symbol">||</span> r1 <span class="sh_symbol">&gt;</span> r <span class="sh_symbol">||</span> c1 <span class="sh_symbol">&lt;=</span> <span class="sh_number">0</span> <span class="sh_symbol">||</span> c1 <span class="sh_symbol">&gt;</span> c<span class="sh_symbol">)</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>jt <span class="sh_symbol">=</span> q<span class="sh_symbol">.</span><span class="sh_function">find</span><span class="sh_symbol">(</span>r1<span class="sh_symbol">,</span> c1<span class="sh_symbol">))</span> Graph<span class="sh_symbol">::</span><span class="sh_function">addedge</span><span class="sh_symbol">(</span>it<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">,</span> jt<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">);</span>
            <span class="sh_keyword">else</span> <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>m<span class="sh_symbol">.</span><span class="sh_function">find</span><span class="sh_symbol">(</span>r1<span class="sh_symbol">,</span> c1<span class="sh_symbol">))</span> Graph<span class="sh_symbol">::</span>is_second<span class="sh_symbol">[</span>it<span class="sh_symbol">-&gt;</span>v<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> T<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>T<span class="sh_symbol">);</span> T<span class="sh_symbol">;</span> <span class="sh_symbol">--</span>T<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>r<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>c<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">);</span>
        m<span class="sh_symbol">.</span><span class="sh_function">resize</span><span class="sh_symbol">(</span>r<span class="sh_symbol">,</span> c<span class="sh_symbol">);</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
            <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d"</span><span class="sh_symbol">,</span> x <span class="sh_symbol">+</span> i<span class="sh_symbol">,</span> y <span class="sh_symbol">+</span> i<span class="sh_symbol">);</span>
            m<span class="sh_symbol">.</span><span class="sh_function">insert</span><span class="sh_symbol">(</span>x<span class="sh_symbol">[</span>i<span class="sh_symbol">],</span> y<span class="sh_symbol">[</span>i<span class="sh_symbol">],</span> i<span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">((</span>ll<span class="sh_symbol">)</span>n <span class="sh_symbol">&gt;=</span> <span class="sh_symbol">(</span>ll<span class="sh_symbol">)</span>r <span class="sh_symbol">*</span> c <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span><span class="sh_function">puts</span><span class="sh_symbol">(</span><span class="sh_string">"-1"</span><span class="sh_symbol">);</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">((</span>ll<span class="sh_symbol">)</span>n <span class="sh_symbol">==</span> <span class="sh_symbol">(</span>ll<span class="sh_symbol">)</span>r <span class="sh_symbol">*</span> c <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_type">int</span> cnt <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> r <span class="sh_symbol">&amp;&amp;</span> cnt <span class="sh_symbol">&lt;</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
                <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> c <span class="sh_symbol">&amp;&amp;</span> cnt <span class="sh_symbol">&lt;</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> j<span class="sh_symbol">++)</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>m<span class="sh_symbol">.</span><span class="sh_function">find</span><span class="sh_symbol">(</span>i<span class="sh_symbol">,</span> j<span class="sh_symbol">))</span><span class="sh_cbracket">{</span>
                        x<span class="sh_symbol">[++</span>cnt<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span> y<span class="sh_symbol">[</span>cnt<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> j<span class="sh_symbol">;</span>
                    <span class="sh_cbracket">}</span>
            <span class="sh_function">puts</span><span class="sh_symbol">(</span><span class="sh_function">abs</span><span class="sh_symbol">(</span>x<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span> x<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">])</span> <span class="sh_symbol">+</span> <span class="sh_function">abs</span><span class="sh_symbol">(</span>y<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span> y<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">])</span> <span class="sh_symbol">==</span> <span class="sh_number">1</span> <span class="sh_symbol">?</span> <span class="sh_string">"-1"</span> <span class="sh_symbol">:</span> <span class="sh_string">"0"</span><span class="sh_symbol">);</span>
            <span class="sh_keyword">continue</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
        flag <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
        <span class="sh_function">memset</span><span class="sh_symbol">(</span>used<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> used<span class="sh_symbol">);</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>used<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
                <span class="sh_function">bfs</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span>
                <span class="sh_function">build_graph</span><span class="sh_symbol">();</span>
                Graph<span class="sh_symbol">::</span><span class="sh_function">tarjan</span><span class="sh_symbol">();</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>Graph<span class="sh_symbol">::</span>connected_component_count <span class="sh_symbol">&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                    <span class="sh_function">puts</span><span class="sh_symbol">(</span><span class="sh_string">"0"</span><span class="sh_symbol">);</span>
                    <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
                <span class="sh_cbracket">}</span><span class="sh_keyword">else</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>Graph<span class="sh_symbol">::</span>cut_point_existence<span class="sh_symbol">)</span>
                    flag <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>r <span class="sh_symbol">==</span> <span class="sh_number">1</span> <span class="sh_symbol">||</span> c <span class="sh_symbol">==</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> flag <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">&gt;=</span> n<span class="sh_symbol">)</span> <span class="sh_function">puts</span><span class="sh_symbol">(</span>flag <span class="sh_symbol">?</span> <span class="sh_string">"1"</span> <span class="sh_symbol">:</span> <span class="sh_string">"2"</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p>这题的代码难度是<del>相当大</del>的，聚集了许许多多的著(jian)名(dan)算法，<del>因此我的代码可能就显得灰常长</del>，然后就莫名其妙地拿了 rank 2 <del>(请无视拿这份代码卡常的人)</del>。</p>
<p>主要算法有：Hash_Map、 Tarjan 割点、bfs (或并查集 Union-Find) 和压缩算法，有如下坑：</p>
<p><b>坑1：</b>在 bfs 时，判重的部分要写在队尾，不能写在队头，否则会造成同一个元素<strong>多次入队</strong>，从而导致构造除了一个具有 (不是重边而是) 重点的图！</p>
<p><b>坑2：</b>如果没找到割点，并不代表答案一定是 $2$，当 $r = 1$ 或 $c = 1$ 时，答案<strong>至多是 $1$，不会是 $2$</strong>，这个时候需要特判的。</p>
