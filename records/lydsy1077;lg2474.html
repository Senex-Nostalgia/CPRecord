<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>你有 $n$ 个砝码，均为 $1 \texttt g$，$2 \texttt g$ 或者 $3 \texttt g$。你并不清楚每个砝码的重量，但你知道其中一些砝码重量的大小关系。</p>
<p>你把其中两个砝码 $A$ 和 $B$ 放在天平的左边，需要另外选出两个砝码放在天平的右边。</p>
<p>问：有多少种选法使得天平的左边重 ($c_1$)、一样重 ($c_2$)、右边重 ($c_3$)？(只有结果保证惟一的选法才统计在内)</p>

<h3>输入格式</h3>
<p>第一行包含三个正整数 $n, A, B$ ($4 \leq n \leq 50; 1 \leq A, B \leq n; A \neq B$)，砝码编号为 $1 \sim n$。</p>
<p>以下 $n$ 行包含重量关系矩阵，其中第 $i$ 行第 $j$ 个字符表示砝码 $i$ 与砝码 $j$ 之间的关系，其中加号 $\texttt +$ 表示砝码 $i$ 比砝码 $j$ 重，减号 $\texttt -$ 表示砝码 $i$ 比砝码 $j$ 轻，等号 $\texttt =$ 表示砝码 $i$ 和砝码 $j$ 一样重，问号 $\texttt ?$ 表示二者的关系未知。保证关系矩阵满足反对称性，且存在一种情况符合该矩阵。</p>

<h3>输出格式</h3>
<p>输出一行，包含三个整数，即 $c_1, c_2, c_3$。</p>

<h3>题解</h3>
<p>由于 $n$ 并不是很大，因此枚举无序组 $(i, j)$，其中 $A, B, i, j$ 互不相等，我们就是要找有多少对这样的 $(i, j)$ 满足 $w_A + w_B &gt; w_i + w_j$ 恒成立，等于和小于同理。</p>
<p>$w_A + w_B &gt; w_i + w_j$ 恒成立，这个式子并不好处理，但是我们可以将它作一个恒等变形，变成 $w_A - w_i &gt; w_j - w_B$ 恒成立。那么也就是说无论 $w_A, w_B, w_i, w_j$ 怎么取都要满足上式，即 <strong>$w_A - w_i$ 的最小值大于 $w_j - w_B$ 的最大值</strong>。</p>
<p>这样一来，我们需要知道对于任意的 $i, j$，$w_i - w_j$ 的<strong>最大/小值</strong>，由于 $1 \leq w_i \leq 3$，于是它们均有一个<strong>下界</strong> $-2$ 和<strong>上界</strong> $2$，当然这个界太松了。</p>
<p>于是对于每个 (非问号) 关系，比如 $w_i &gt; w_j$，(由于离散性) 此时我们可以将 $w_i - w_j$ 的下界更新为 $1$；同样，如果 $w_i &lt; w_j$，可以将 $w_i - w_j$ 的上界更新为 $-1$；当然如果 $w_i = w_j$，那么 $w_i - w_j$ 的上下界均为 $0$。</p>
<p>那么最后求任意的上下界简单了，直接使用 Floyd 算法即可。注意求下界时取 $\min$，比如 $w_i - w_j &lt; a, w_j - w_k &lt; b \wedge w_i - w_k &lt; c$，那么有 $w_i - w_k &lt; \min \{a + b, c\}$，当然求上界就是用 $\max$ 啦。</p>
<p>最后就是判断的问题。如果 $w_A + w_B &gt; w_i + w_j$，那么它等价于 $\inf (w_A - w_i) &gt; \sup (w_j - w_B)$；如果 $w_A + w_B &lt; w_i + w_j$，就等价于 $\sup (w_A - w_i) &lt; \inf (w_j - w_B)$。</p>
<p>两端相等的情况略有复杂，因为我们需要知道明确的关系：比如，$w_A - w_i$ 已知，$w_j - w_B$ 已知，且它们的值相等，此即 $\sup (w_A - w_i) = \inf (w_A - w_i) = \sup (w_j - w_B) = \inf (w_j - w_B)$。</p>
<p>最后统计即可，时间复杂度 $O(n^3)$ (Floyd 复杂度)。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">68</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_type">int</span> n<span class="sh_symbol">,</span> A<span class="sh_symbol">,</span> B<span class="sh_symbol">;</span>
<span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">;</span>
<span class="sh_type">int</span> gt<span class="sh_symbol">,</span> eq<span class="sh_symbol">,</span> lt<span class="sh_symbol">;</span>
<span class="sh_type">int</span> lb<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>N<span class="sh_symbol">],</span> ub<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>N<span class="sh_symbol">];</span>
<span class="sh_comment">// lb[i][j]: the lower_bound of i - j, ub[i][j]: the upper_bound of i - j</span>
<span class="sh_type">char</span> str<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">up</span><span class="sh_symbol">(</span><span class="sh_type">int</span> <span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_keyword">const</span> <span class="sh_type">int</span> y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>x <span class="sh_symbol">&lt;</span> y <span class="sh_symbol">?</span> x <span class="sh_symbol">=</span> y <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">down</span><span class="sh_symbol">(</span><span class="sh_type">int</span> <span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_keyword">const</span> <span class="sh_type">int</span> y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>x <span class="sh_symbol">&gt;</span> y <span class="sh_symbol">?</span> x <span class="sh_symbol">=</span> y <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>A<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>B<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%s"</span><span class="sh_symbol">,</span> str<span class="sh_symbol">),</span> j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">==</span> j<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
            <span class="sh_keyword">switch</span><span class="sh_symbol">(</span>str<span class="sh_symbol">[</span>j <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
                <span class="sh_keyword">case</span> <span class="sh_number">61</span><span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
                <span class="sh_keyword">case</span> <span class="sh_number">43</span><span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
                <span class="sh_keyword">case</span> <span class="sh_number">45</span><span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">2</span><span class="sh_symbol">;</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
                <span class="sh_keyword">default</span><span class="sh_symbol">:</span> <span class="sh_cbracket">{</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">2</span><span class="sh_symbol">;</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>k<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                <span class="sh_function">up</span><span class="sh_symbol">(</span>lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">],</span> lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> lb<span class="sh_symbol">[</span>k<span class="sh_symbol">][</span>j<span class="sh_symbol">]);</span>
                <span class="sh_function">down</span><span class="sh_symbol">(</span>ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">],</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> ub<span class="sh_symbol">[</span>k<span class="sh_symbol">][</span>j<span class="sh_symbol">]);</span>
            <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">!=</span> A <span class="sh_symbol">&amp;&amp;</span> i <span class="sh_symbol">!=</span> B<span class="sh_symbol">)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> i <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>j <span class="sh_symbol">!=</span> A <span class="sh_symbol">&amp;&amp;</span> j <span class="sh_symbol">!=</span> B<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> ub<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">||</span> lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>B<span class="sh_symbol">])</span> <span class="sh_symbol">++</span>gt<span class="sh_symbol">;</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>ub<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;</span> lb<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">||</span> ub<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;</span> lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>B<span class="sh_symbol">])</span> <span class="sh_symbol">++</span>lt<span class="sh_symbol">;</span>
                    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>ub<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> ub<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> ub<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> lb<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">||</span>
                       ub<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> lb<span class="sh_symbol">[</span>A<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> ub<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>B<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> lb<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>B<span class="sh_symbol">])</span> <span class="sh_symbol">++</span>eq<span class="sh_symbol">;</span>
                <span class="sh_cbracket">}</span>
    <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d %d %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> gt<span class="sh_symbol">,</span> eq<span class="sh_symbol">,</span> lt<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p><strong>坑1：</strong>注意对于 $i = j$，数据给的关系<strong>仍有可能是 $\texttt ?$</strong> (但不可能是 $\texttt +$ 或 $\texttt -$)，然而实际的关系显然是 $\texttt =$，因此需要特判为等号。</p>
<p><strong>坑2：</strong>最后判断时，不能 $A$ 只和 $i$ 配对。假如枚举了无序组 $(i, j)$ 后，题目给的关系是 $w_A = w_j, w_B = w_i$，那么把它们俩放上去显然是相等的。但是算法中 $w_A - w_i$ 并不是确定的，也就是说，<strong>$A$ 也要和 $j$ 去配对尝试</strong> (三种情况都要哦)。</p>

