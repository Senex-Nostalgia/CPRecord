<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>为了庆祝 NOI 的成功开幕，主办方为大家准备了一场寿司晚宴。A 和 B 作为参加 NOI 的选手，也被邀请参加了寿司晚宴。</p>
<p>在晚宴上，主办方为大家提供了 $n − 1$ 种不同的寿司，编号 $1, 2, 3, \dots, n − 1$，其中第 $i$ 种寿司的美味度为 $i + 1$ (即寿司的美味度为从 $2$ 到 $n$)。</p>
<p>现在 A 和 B 希望每人选一些寿司种类来品尝，她们规定一种品尝方案为不和谐的当且仅当：A 品尝的寿司种类中存在一种美味度为 $x$ 的寿司，B 品尝的寿司中存在一种美味度为 $y$ 的寿司，而 $x$ 与 $y$ 不互质。</p>
<p>现在 A 和 B 希望统计一共有多少种和谐的品尝寿司的方案 (对给定的正整数 $p$ 取模)。注意一个人可以不吃任何寿司。</p>

<h3>输入格式</h3>
<p>输入共一行，包含两个正整数 $n, p$ ($n \leq 500, p \leq 10^9$)，中间用一个空格隔开，表示共有 $n$ 种寿司，最终和谐的方案数要对 $p$ 取模。</p>

<h3>输出格式</h3>
<p>输出共一行，包含一个整数，表示所求的方案模 $p$ 的结果。</p>

<h3>题解</h3>
<p>这题有好多人打表耶！</p>
<p>因为 $p$ 是模数，所以此题是一个<strong>单变量函数</strong>，打完表后边读边取模 (就像秦九韶算法一样)，它的表见 <a href="http://oeis.org/A260185" target="_blank">A260185</a>，不过只有前 100 项，</p>
<p>下面讲正解 (非打表)：</p>
<p>注意到，$n$ 只到 $500$，且两个数互素<strong>当且仅当</strong>它们所含有的素因子各不相同，因此考虑素因子。</p>
<p>注意到，一个数 $r$ 至多只有一个 $&gt; \sqrt r$ 的素因子，所以在 $500$ 以内，一个数中至多有一个 $\geq 23$ 的素因子 (含重数)。</p>
<p>考虑两个人所选择的寿司 (美味度) 的集合 $A, B$，考虑到 $A$ 中任一元素与 $B$ 中任一元素互素，也就是说 $A$ 的素因子集合 $\mathrm{fac}(A)$ 和 $B$ 的素因子集合 $\mathrm{fac}(B)$ 的交集为空，所以可以考虑 DP。</p>
<p>又因为 $\geq 23$ 的素因子只有一个，所以我们考虑 $A, B$ 中 $\leq 19$ 的素因子的选择方式，因为 $\leq 19$ 的素数<strong>只有 $8$ 个</strong>，记 $A$ 的 $\leq 19$ 的素因子集合为 $\mathrm{fac}(A) \cap \left\{ 2, 3, 5, 7, 11, 13, 17, 19 \right\} = g(A)$，同理记 $B$ 的为 $g(B)$，于是集合 $g(A), g(B)$ 可以分别映射到 $0 \sim 2^8 - 1$ 之间的一个整数。</p>
<p>记：$p_i$ 为从 $2$ 起的第 $i$ 个素数 (如 $p_1 = 2, p_2 = 3, \cdots, p_8 = 19, p_9 = 23, \cdots, p_{95} = 499$)，记 $\geq 23$ 的素数为<strong>大素数</strong>，否则称为<strong>小素数</strong>。</p>
<p>$f_{i, X, Y}$ ($i \geq 9$) 表示 <strong>$A, B$ 集合的所有素因子均为 $p_1 \sim p_{i-1}$，且 $g(A) = X, g(B) = Y$ 的方案个数</strong>。</p>
<p>$g_{0, i, j, X, Y}$ ($i \geq 9$) 表示 <strong>$A, B$ 集合的所有素因子均为 $p_1 \sim p_i$，且 $\mathrm{fac}(A)$ 可能包含 $p_i$ 但是为具有大素数 $p_i$ 的第 $j$ 个数之前的数，$\mathrm{fac}(B)$ 不包含 $p_i$，$g(A) = X, g(B) = Y$ 的方案个数</strong>，$g_{1, i, j, X, Y}$ 同理 (就是 $A$ 不包含，$B$ 可能包含)。</p>
<p>将 $1 \sim n$ 中的大素数排序后，就可以进行如下转移：</p>
<p>当枚举到新的大素数 $p_i$ ($i \geq 9$) 或不存在大素数时，可以先使：</p>
<p>$$ g_{0, i, 0, X, Y}, g_{1, i, 0, X, Y} \gets f_{i, X, Y} $$</p>
<p>当枚举到具有大素数 $p_i$ 的第 $j$ 个数 $r$ 时，对于每一种 $X, Y$，若 $r$ 的小素因子集合 $g(r)$ 与 $Y$ 的交集为空，则可以做如下转移：</p>
<p>$$ g_{0, i, j, X \cup g(r), Y} \gets g_{0, i, j-1, X \cup g(r), Y} + g_{0, i, j-1, X, Y} $$</p>
<p>同理，若 $g(r) \cap X = \varnothing$，则有：</p>
<p>$$ g_{1, i, j, X, Y \cup g(r)} \gets g_{1, i, j-1, X, Y \cup g(r)} + g_{1, i, j-1, X, Y} $$</p>
<p>最后就有：</p>
<p>$$ f_{i+1, X, Y} \gets g_{0, i, \lambda_i, X, Y} + g_{1, i, \lambda_i, X, Y} - f_{i, X, Y}$$</p>
<p>其中 $\lambda_i$ 为具有大素数 $p_i$ 的数的个数，这里运用了<strong>容斥原理</strong>，因为 $A, B$ 均不包含 $p_i$ 的方案被算了两遍。</p>
<p>最终的答案就是 $\sum\limits_X \sum\limits_Y f_{N,X,Y}$，其中最大的大素数为 $p_N$。</p>
<p>这样就得到了一个 DP 方程，根据背包的经验，显然 $f$ 的 $i$ 维和 $g$ 的 $i, j$ 维是可以优化掉的 (但要注意枚举方式哦)，$X, Y$ 用对应的 $0 \sim 2^8 - 1 = 255$ 之间的整数代表。</p>
<p>(注：如果觉得公式不够大的话，可以右键公式 -&gt; Math Settings(数学设置) -&gt; Scale All Math(缩放所有数学) -&gt; 输入一个较大的数)</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">513</span>
<span class="sh_preproc">#define</span> high first
<span class="sh_preproc">#define</span> low second
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> ll<span class="sh_symbol">;</span>
<span class="sh_keyword">typedef</span> pair <span class="sh_symbol">&lt;</span><span class="sh_type">int</span><span class="sh_symbol">,</span> <span class="sh_type">int</span><span class="sh_symbol">&gt;</span> pr<span class="sh_symbol">;</span>

<span class="sh_keyword">const</span> <span class="sh_type">int</span> p<span class="sh_symbol">[</span><span class="sh_number">95</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">11</span><span class="sh_symbol">,</span> <span class="sh_number">13</span><span class="sh_symbol">,</span> <span class="sh_number">17</span><span class="sh_symbol">,</span> <span class="sh_number">19</span><span class="sh_symbol">,</span> <span class="sh_number">23</span><span class="sh_symbol">,</span> <span class="sh_number">29</span><span class="sh_symbol">,</span> <span class="sh_number">31</span><span class="sh_symbol">,</span> <span class="sh_number">37</span><span class="sh_symbol">,</span> <span class="sh_number">41</span><span class="sh_symbol">,</span> <span class="sh_number">43</span><span class="sh_symbol">,</span> <span class="sh_number">47</span><span class="sh_symbol">,</span>  <span class="sh_number">53</span><span class="sh_symbol">,</span>  <span class="sh_number">59</span><span class="sh_symbol">,</span>  <span class="sh_number">61</span><span class="sh_symbol">,</span>  <span class="sh_number">67</span><span class="sh_symbol">,</span>  <span class="sh_number">71</span><span class="sh_symbol">,</span>
 <span class="sh_number">73</span><span class="sh_symbol">,</span>  <span class="sh_number">79</span><span class="sh_symbol">,</span>  <span class="sh_number">83</span><span class="sh_symbol">,</span>  <span class="sh_number">89</span><span class="sh_symbol">,</span>  <span class="sh_number">97</span><span class="sh_symbol">,</span> <span class="sh_number">101</span><span class="sh_symbol">,</span> <span class="sh_number">103</span><span class="sh_symbol">,</span> <span class="sh_number">107</span><span class="sh_symbol">,</span> <span class="sh_number">109</span><span class="sh_symbol">,</span> <span class="sh_number">113</span><span class="sh_symbol">,</span> <span class="sh_number">127</span><span class="sh_symbol">,</span> <span class="sh_number">131</span><span class="sh_symbol">,</span> <span class="sh_number">137</span><span class="sh_symbol">,</span> <span class="sh_number">139</span><span class="sh_symbol">,</span> <span class="sh_number">149</span><span class="sh_symbol">,</span> <span class="sh_number">151</span><span class="sh_symbol">,</span> <span class="sh_number">157</span><span class="sh_symbol">,</span> <span class="sh_number">163</span><span class="sh_symbol">,</span> <span class="sh_number">167</span><span class="sh_symbol">,</span> <span class="sh_number">173</span><span class="sh_symbol">,</span>
<span class="sh_number">179</span><span class="sh_symbol">,</span> <span class="sh_number">181</span><span class="sh_symbol">,</span> <span class="sh_number">191</span><span class="sh_symbol">,</span> <span class="sh_number">193</span><span class="sh_symbol">,</span> <span class="sh_number">197</span><span class="sh_symbol">,</span> <span class="sh_number">199</span><span class="sh_symbol">,</span> <span class="sh_number">211</span><span class="sh_symbol">,</span> <span class="sh_number">223</span><span class="sh_symbol">,</span> <span class="sh_number">227</span><span class="sh_symbol">,</span> <span class="sh_number">229</span><span class="sh_symbol">,</span> <span class="sh_number">233</span><span class="sh_symbol">,</span> <span class="sh_number">239</span><span class="sh_symbol">,</span> <span class="sh_number">241</span><span class="sh_symbol">,</span> <span class="sh_number">251</span><span class="sh_symbol">,</span> <span class="sh_number">257</span><span class="sh_symbol">,</span> <span class="sh_number">263</span><span class="sh_symbol">,</span> <span class="sh_number">269</span><span class="sh_symbol">,</span> <span class="sh_number">271</span><span class="sh_symbol">,</span> <span class="sh_number">277</span><span class="sh_symbol">,</span> <span class="sh_number">281</span><span class="sh_symbol">,</span>
<span class="sh_number">283</span><span class="sh_symbol">,</span> <span class="sh_number">293</span><span class="sh_symbol">,</span> <span class="sh_number">307</span><span class="sh_symbol">,</span> <span class="sh_number">311</span><span class="sh_symbol">,</span> <span class="sh_number">313</span><span class="sh_symbol">,</span> <span class="sh_number">317</span><span class="sh_symbol">,</span> <span class="sh_number">331</span><span class="sh_symbol">,</span> <span class="sh_number">337</span><span class="sh_symbol">,</span> <span class="sh_number">347</span><span class="sh_symbol">,</span> <span class="sh_number">349</span><span class="sh_symbol">,</span> <span class="sh_number">353</span><span class="sh_symbol">,</span> <span class="sh_number">359</span><span class="sh_symbol">,</span> <span class="sh_number">367</span><span class="sh_symbol">,</span> <span class="sh_number">373</span><span class="sh_symbol">,</span> <span class="sh_number">379</span><span class="sh_symbol">,</span> <span class="sh_number">383</span><span class="sh_symbol">,</span> <span class="sh_number">389</span><span class="sh_symbol">,</span> <span class="sh_number">397</span><span class="sh_symbol">,</span> <span class="sh_number">401</span><span class="sh_symbol">,</span> <span class="sh_number">409</span><span class="sh_symbol">,</span>
<span class="sh_number">419</span><span class="sh_symbol">,</span> <span class="sh_number">421</span><span class="sh_symbol">,</span> <span class="sh_number">431</span><span class="sh_symbol">,</span> <span class="sh_number">433</span><span class="sh_symbol">,</span> <span class="sh_number">439</span><span class="sh_symbol">,</span> <span class="sh_number">443</span><span class="sh_symbol">,</span> <span class="sh_number">449</span><span class="sh_symbol">,</span> <span class="sh_number">457</span><span class="sh_symbol">,</span> <span class="sh_number">461</span><span class="sh_symbol">,</span> <span class="sh_number">463</span><span class="sh_symbol">,</span> <span class="sh_number">467</span><span class="sh_symbol">,</span> <span class="sh_number">479</span><span class="sh_symbol">,</span> <span class="sh_number">487</span><span class="sh_symbol">,</span> <span class="sh_number">491</span><span class="sh_symbol">,</span> <span class="sh_number">499</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_type">int</span> c<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>

<span class="sh_usertype">ll</span><span class="sh_normal"> </span>mod<span class="sh_symbol">,</span> ans <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_type">int</span> n<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">;</span>
<span class="sh_usertype">pr</span><span class="sh_normal"> </span>z<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>
<span class="sh_usertype">ll</span><span class="sh_normal"> </span>f<span class="sh_symbol">[</span>N<span class="sh_symbol">][</span>N<span class="sh_symbol">],</span> g<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">][</span>N<span class="sh_symbol">][</span>N<span class="sh_symbol">];</span>

<span class="sh_type">void</span> <span class="sh_function">init</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span><span class="sh_function">memset</span><span class="sh_symbol">(</span>c<span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> c<span class="sh_symbol">);</span> <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">95</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> c<span class="sh_symbol">[</span>p<span class="sh_symbol">[</span>i<span class="sh_symbol">]]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">Factor</span><span class="sh_symbol">(</span><span class="sh_type">int</span> s<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> x <span class="sh_symbol">=</span> s<span class="sh_symbol">,</span> i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    z<span class="sh_symbol">[</span>s<span class="sh_symbol">].</span>low <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">8</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!(</span>x <span class="sh_symbol">%</span> p<span class="sh_symbol">[</span>i<span class="sh_symbol">]))</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>z<span class="sh_symbol">[</span>s<span class="sh_symbol">].</span>low <span class="sh_symbol">|=</span> <span class="sh_number">1</span> <span class="sh_symbol">&lt;&lt;</span> i<span class="sh_symbol">;</span> <span class="sh_symbol">!(</span>x <span class="sh_symbol">%</span> p<span class="sh_symbol">[</span>i<span class="sh_symbol">]);</span> x <span class="sh_symbol">/=</span> p<span class="sh_symbol">[</span>i<span class="sh_symbol">]);</span>
    z<span class="sh_symbol">[</span>s<span class="sh_symbol">].</span>high <span class="sh_symbol">=</span> c<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">init</span><span class="sh_symbol">();</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%lld"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>mod<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span> <span class="sh_function">Factor</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span>
    <span class="sh_comment">// a[i].high is the max prime of i</span>
    <span class="sh_comment">// a[i].low is the combination of the primes less than sqrt(i)</span>
    <span class="sh_function">sort</span><span class="sh_symbol">(</span>z <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">,</span> z <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>n <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">));</span>
    z<span class="sh_symbol">[</span>n <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">].</span>high <span class="sh_symbol">=</span> INT_MAX<span class="sh_symbol">;</span>
    f<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span><span class="sh_cbracket">{</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!(~</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>high <span class="sh_symbol">&amp;&amp;</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>high <span class="sh_symbol">==</span> z<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">].</span>high<span class="sh_symbol">))</span><span class="sh_cbracket">{</span> <span class="sh_comment">// new block</span>
            <span class="sh_function">memcpy</span><span class="sh_symbol">(</span>g<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">],</span> f<span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span>
            <span class="sh_function">memcpy</span><span class="sh_symbol">(</span>g<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">],</span> f<span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> f<span class="sh_symbol">);</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">255</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j<span class="sh_symbol">--)</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">255</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k<span class="sh_symbol">--)</span><span class="sh_cbracket">{</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>j <span class="sh_symbol">&amp;</span> k<span class="sh_symbol">)</span> <span class="sh_keyword">continue</span><span class="sh_symbol">;</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(!(</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>low <span class="sh_symbol">&amp;</span> k<span class="sh_symbol">))</span> <span class="sh_symbol">(</span>g<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span>j <span class="sh_symbol">|</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>low<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> g<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
                <span class="sh_keyword">if</span><span class="sh_symbol">(!(</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>low <span class="sh_symbol">&amp;</span> j<span class="sh_symbol">))</span> <span class="sh_symbol">(</span>g<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span>k <span class="sh_symbol">|</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>low<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> g<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!(~</span>z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>high <span class="sh_symbol">&amp;&amp;</span> z<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>high <span class="sh_symbol">==</span> z<span class="sh_symbol">[</span>i <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">].</span>high<span class="sh_symbol">))</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;</span> <span class="sh_number">256</span><span class="sh_symbol">;</span> j<span class="sh_symbol">++)</span>
                <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;</span> <span class="sh_number">256</span><span class="sh_symbol">;</span> k<span class="sh_symbol">++)</span>
                    j <span class="sh_symbol">&amp;</span> k <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> f<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>g<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> g<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">-</span> f<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;</span> <span class="sh_number">256</span><span class="sh_symbol">;</span> j<span class="sh_symbol">++)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;</span> <span class="sh_number">256</span><span class="sh_symbol">;</span> k<span class="sh_symbol">++)</span>
            j <span class="sh_symbol">&amp;</span> k <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> <span class="sh_symbol">(</span>ans <span class="sh_symbol">+=</span> f<span class="sh_symbol">[</span>j<span class="sh_symbol">][</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">%=</span> mod<span class="sh_symbol">;</span>
    <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> <span class="sh_symbol">(</span><span class="sh_type">int</span><span class="sh_symbol">)</span>ans<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p>其实初始的赋值是可以由 <code>memcpy()</code> 完成的……</p>
<p><b>坑1：</b>DP 的时候，比如说转移 $g_{0, i, j, X \cup g(r), Y}$ 时，是要求 $g(r) \cap Y = \varnothing$，而不是 $g(r) \cap X = \varnothing$，因为 $X$ 是并上 $g(r)$ 的，它们两个是否有交集不重要，但是要保证 $X \cup g(r)$ 与 $Y$ 不相交，因此 $g(r)$ 与 $Y$ 必定不相交，<del>否则好像连样例 2 都过不了</del>。</p>
