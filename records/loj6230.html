<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>给定一个点集，问它是否轴对称。</p>
<p style="color: red">ps: 点集是一个集合，没有重复的元素。</p>

<h3>输入格式</h3>
<p>第一行包含一个正整数 $n$ ($n \leq 2 \times 10^5$)，表示点集的大小。</p>
<p>接下来 $n$ 行，每行包含两个<strong>整数</strong> $x, y$ ($|x|, |y| \leq 10^{12}$)，表示点集中一个点的坐标。</p>

<h3>输出格式</h3>
<p>输出 <code>YES</code> (轴对称) 或 <code>NO</code> (不是轴对称)。</p>

<h3>题解</h3>
<p>先特判如果 $n \leq 2$，直接输出 <code>YES</code> 即可 <del>(事实上没有这样的数据)</del>。</p>
<p>考虑一个对称点集的对称轴，那么有两种情况：</p>
<ol>
<li>所有点都在对称轴上。那么直接特判是否 $n$ 点共线，若共线输出 <code>YES</code>，否则进入 2。</li>
<li>有的点不在对称轴上。那么我们考虑暴力，暴力就是枚举不在对称轴上的两点，求中垂线的方程，然后检验。</li>
</ol>
<p>然而这样暴力最坏情况下是 $O(n^3)$ 的，显然不行，考虑进行优化。</p>
<p>首先，对于已知的点 $p_i$ 和 $p_j$，可以求出其中垂线方程 $l: Ax + By + C = 0$，然后我们并不需要每一对检验，可以<strong>随机选取几个点</strong> (假设是 $T$ 个)，算出它们关于 $l$ 的对称点，判断那些对称点<strong>是否均为整点且为已知点</strong>。</p>
<p>判断一个点是否在一个集合中，可以用 <code>set</code>，但是要多一个 $\log n$，不过由于用不到顺序性，<strong>可以使用 <code>hash_set</code> (Hash 表) 来完成</strong>，复杂度 $O(1)$。</p>
<p>如果这些检验均通过，然后这条直线<strong>很可能就是对称轴</strong>，我们可以花 $O(n)$ 的时间一一检验，检验的时候注意配对，即一个点被检验成功了，它的对称点就不用被检验了。</p>
<p>这样平均复杂度就降到了 $O(T n^2)$。</p>
<p>然而由于这道题的时间有点紧 ($0.5 \texttt{s}$)，因此要再考虑一些优 (ji) 化 (liang)，即枚举的时候不能傻傻地两层 <code>for()</code>。</p>
<p>如果对称轴两边的点是非常多的，可以考虑使用 Las-Vegas 概率算法，每次随机两个点 $u, v$ 作为一对对称点，算出中垂线并检验，直接时间超时为止，如果还未找出对称轴就输出 <code>NO</code>。</p>
<p>如果对称轴两边的点比较少 (那么对称轴上就有一堆点了)，还是用 Las-Vegas 概率算法，每次随机两个点 $u, v$ 作为对称轴上的两点，同理算出对称轴并检验。</p>
<p>时间复杂度 $o(n^2) = O(0.5 \texttt{s})$ (注意是小 $o$)，能卡过去 <del>(由于用了随机算法，因此成功在 LOJ 上垫底，不过代码长度比较小)</del>。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">256101</span>
<span class="sh_preproc">#define</span> next scx1
<span class="sh_preproc">#define</span> y1 scx2
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> ll<span class="sh_symbol">;</span>
<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">double</span> ld<span class="sh_symbol">;</span>
<span class="sh_keyword">typedef</span> __<span class="sh_usertype">int128</span><span class="sh_normal"> </span>lll<span class="sh_symbol">;</span>
<span class="sh_keyword">const</span> <span class="sh_type">int</span> HASH_MAX <span class="sh_symbol">=</span> <span class="sh_number">0xffffff</span><span class="sh_symbol">;</span>
<span class="sh_keyword">const</span> <span class="sh_type">int</span> threshold <span class="sh_symbol">=</span> <span class="sh_number">10</span><span class="sh_symbol">;</span>
<span class="sh_keyword">const</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span>eps <span class="sh_symbol">=</span> <span class="sh_number">1e-5</span><span class="sh_symbol">;</span>

<span class="sh_keyword">struct</span><span class="sh_normal"> </span><span class="sh_classname">vec2</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">ll</span><span class="sh_normal"> </span>x<span class="sh_symbol">,</span> y<span class="sh_symbol">;</span>
    <span class="sh_function">vec2</span> <span class="sh_symbol">(</span><span class="sh_usertype">ll</span><span class="sh_normal"> </span>x0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_usertype">ll</span><span class="sh_normal"> </span>y0 <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">):</span> <span class="sh_function">x</span><span class="sh_symbol">(</span>x0<span class="sh_symbol">),</span> <span class="sh_function">y</span><span class="sh_symbol">(</span>y0<span class="sh_symbol">)</span> <span class="sh_cbracket">{}</span>
    vec2 <span class="sh_symbol">*</span> <span class="sh_function">read</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span><span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%lld%lld"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>y<span class="sh_symbol">);</span> <span class="sh_keyword">return</span> <span class="sh_keyword">this</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">+</span> <span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_function">vec2</span><span class="sh_symbol">(</span>x <span class="sh_symbol">+</span> b<span class="sh_symbol">.</span>x<span class="sh_symbol">,</span> y <span class="sh_symbol">+</span> b<span class="sh_symbol">.</span>y<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">-</span> <span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_function">vec2</span><span class="sh_symbol">(</span>x <span class="sh_symbol">-</span> b<span class="sh_symbol">.</span>x<span class="sh_symbol">,</span> y <span class="sh_symbol">-</span> b<span class="sh_symbol">.</span>y<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span><span class="sh_type">double</span> b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_function">vec2</span><span class="sh_symbol">(</span>x <span class="sh_symbol">*</span> b<span class="sh_symbol">,</span> y <span class="sh_symbol">*</span> b<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">lll</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_symbol">(</span>lll<span class="sh_symbol">)</span>x <span class="sh_symbol">*</span> b<span class="sh_symbol">.</span>x <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>lll<span class="sh_symbol">)</span>y <span class="sh_symbol">*</span> b<span class="sh_symbol">.</span>y<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">lll</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">^</span> <span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_symbol">(</span>lll<span class="sh_symbol">)</span>x <span class="sh_symbol">*</span> b<span class="sh_symbol">.</span>y <span class="sh_symbol">-</span> <span class="sh_symbol">(</span>lll<span class="sh_symbol">)</span>y <span class="sh_symbol">*</span> b<span class="sh_symbol">.</span>x<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">inline</span> <span class="sh_usertype">lll</span><span class="sh_normal"> </span><span class="sh_function">norm2</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_symbol">*</span><span class="sh_keyword">this</span> <span class="sh_symbol">*</span> <span class="sh_symbol">*</span><span class="sh_keyword">this</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_type">int</span> cnt<span class="sh_symbol">,</span> first<span class="sh_symbol">[</span>HASH_MAX <span class="sh_symbol">+</span> <span class="sh_number">2</span><span class="sh_symbol">],</span> next<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>

<span class="sh_keyword">inline</span> <span class="sh_type">int</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span><span class="sh_usertype">ll</span><span class="sh_normal"> </span>x<span class="sh_symbol">,</span> <span class="sh_usertype">ll</span><span class="sh_normal"> </span>y<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_symbol">(</span><span class="sh_type">int</span><span class="sh_symbol">)((</span><span class="sh_number">85367</span> <span class="sh_symbol">*</span> x <span class="sh_symbol">+</span> y<span class="sh_symbol">)</span> <span class="sh_symbol">&amp;</span> HASH_MAX<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>

<span class="sh_type">int</span> TIME_LIMIT<span class="sh_symbol">;</span>

<span class="sh_type">bool</span> flag <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
<span class="sh_type">int</span> n<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> u<span class="sh_symbol">,</span> v<span class="sh_symbol">;</span>
<span class="sh_type">int</span> tag<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>
<span class="sh_usertype">ld</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> B<span class="sh_symbol">,</span> C<span class="sh_symbol">,</span> x1<span class="sh_symbol">,</span> y1<span class="sh_symbol">;</span>
<span class="sh_usertype">vec2</span><span class="sh_normal"> </span>a<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span>

<span class="sh_type">int</span> <span class="sh_function">find</span><span class="sh_symbol">(</span><span class="sh_usertype">ll</span><span class="sh_normal"> </span>x<span class="sh_symbol">,</span> <span class="sh_usertype">ll</span><span class="sh_normal"> </span>y<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> H <span class="sh_symbol">=</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span>x<span class="sh_symbol">,</span> y<span class="sh_symbol">),</span> i<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>H<span class="sh_symbol">];</span> <span class="sh_symbol">~</span>i<span class="sh_symbol">;</span> i <span class="sh_symbol">=</span> next<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>x <span class="sh_symbol">==</span> x <span class="sh_symbol">&amp;&amp;</span> a<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span>y <span class="sh_symbol">==</span> y<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> i<span class="sh_symbol">;</span>
    <span class="sh_keyword">return</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">insert</span><span class="sh_symbol">(</span><span class="sh_type">int</span> id<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> H <span class="sh_symbol">=</span> <span class="sh_function">getHash</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>id<span class="sh_symbol">].</span>x<span class="sh_symbol">,</span> a<span class="sh_symbol">[</span>id<span class="sh_symbol">].</span>y<span class="sh_symbol">);</span>
    next<span class="sh_symbol">[</span>id<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> first<span class="sh_symbol">[</span>H<span class="sh_symbol">];</span> first<span class="sh_symbol">[</span>H<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> id<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_keyword">inline</span> <span class="sh_type">int</span> <span class="sh_function">quit</span><span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_type">char</span> <span class="sh_symbol">*</span>_str<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%s</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> _str<span class="sh_symbol">),</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">getLine</span><span class="sh_symbol">(</span><span class="sh_usertype">vec2</span><span class="sh_normal"> </span>u<span class="sh_symbol">,</span> <span class="sh_usertype">vec2</span><span class="sh_normal"> </span>v<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>A<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>B<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>C<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">vec2</span><span class="sh_normal"> </span>t <span class="sh_symbol">=</span> v <span class="sh_symbol">-</span> u<span class="sh_symbol">;</span>
    A <span class="sh_symbol">=</span> t<span class="sh_symbol">.</span>x<span class="sh_symbol">;</span> B <span class="sh_symbol">=</span> t<span class="sh_symbol">.</span>y<span class="sh_symbol">;</span> C <span class="sh_symbol">=</span> <span class="sh_number">0.5l</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>ld<span class="sh_symbol">)(</span>u<span class="sh_symbol">.</span><span class="sh_function">norm2</span><span class="sh_symbol">()</span> <span class="sh_symbol">-</span> v<span class="sh_symbol">.</span><span class="sh_function">norm2</span><span class="sh_symbol">());</span>
<span class="sh_cbracket">}</span>

<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">getSymmetry</span><span class="sh_symbol">(</span><span class="sh_usertype">vec2</span><span class="sh_normal"> </span>u<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span>B<span class="sh_symbol">,</span> <span class="sh_usertype">ld</span><span class="sh_normal"> </span>C<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">ld</span><span class="sh_normal"> </span>K <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>A <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>ld<span class="sh_symbol">)</span>u<span class="sh_symbol">.</span>x <span class="sh_symbol">+</span> B <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>ld<span class="sh_symbol">)</span>u<span class="sh_symbol">.</span>y <span class="sh_symbol">+</span> C<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_number">2</span><span class="sh_symbol">.</span>0l <span class="sh_symbol">/</span> <span class="sh_symbol">(</span>A <span class="sh_symbol">*</span> A <span class="sh_symbol">+</span> B <span class="sh_symbol">*</span> B<span class="sh_symbol">);</span>
    x1 <span class="sh_symbol">=</span> u<span class="sh_symbol">.</span>x <span class="sh_symbol">-</span> A <span class="sh_symbol">*</span> K<span class="sh_symbol">;</span> y1 <span class="sh_symbol">=</span> u<span class="sh_symbol">.</span>y <span class="sh_symbol">-</span> B <span class="sh_symbol">*</span> K<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">Check</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">ll</span><span class="sh_normal"> </span>Gx <span class="sh_symbol">=</span> <span class="sh_function">llroundl</span><span class="sh_symbol">(</span>x1<span class="sh_symbol">);</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>x1 <span class="sh_symbol">-</span> Gx <span class="sh_symbol">&gt;</span> eps<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_usertype">ll</span><span class="sh_normal"> </span>Gy <span class="sh_symbol">=</span> <span class="sh_function">llroundl</span><span class="sh_symbol">(</span>y1<span class="sh_symbol">);</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>y1 <span class="sh_symbol">-</span> Gy <span class="sh_symbol">&gt;</span> eps<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">return</span> <span class="sh_function">find</span><span class="sh_symbol">(</span>Gx<span class="sh_symbol">,</span> Gy<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">bool</span> <span class="sh_function">CarefulCheck</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">;</span>
    <span class="sh_function">memset</span><span class="sh_symbol">(</span>tag<span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> tag<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>tag<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span><span class="sh_cbracket">{</span>
            <span class="sh_function">getSymmetry</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>i<span class="sh_symbol">],</span> A<span class="sh_symbol">,</span> B<span class="sh_symbol">,</span> C<span class="sh_symbol">);</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">((</span>j <span class="sh_symbol">=</span> <span class="sh_function">Check</span><span class="sh_symbol">())</span> <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span>
            tag<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> tag<span class="sh_symbol">[</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">memset</span><span class="sh_symbol">(</span>first<span class="sh_symbol">,</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> first<span class="sh_symbol">);</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>a<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span><span class="sh_function">read</span><span class="sh_symbol">();</span> <span class="sh_function">insert</span><span class="sh_symbol">(</span>i<span class="sh_symbol">);</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>n <span class="sh_symbol">&lt;=</span> <span class="sh_number">2</span><span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_function">quit</span><span class="sh_symbol">(</span><span class="sh_string">"YES"</span><span class="sh_symbol">);</span> <span class="sh_comment">// less than 3 points</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> <span class="sh_keyword">if</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span> a<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">^</span> a<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span> a<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> <span class="sh_cbracket">{</span>flag <span class="sh_symbol">=</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>flag<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_function">quit</span><span class="sh_symbol">(</span><span class="sh_string">"YES"</span><span class="sh_symbol">);</span> <span class="sh_comment">// in a line</span>
    <span class="sh_function">srand</span><span class="sh_symbol">(</span><span class="sh_function">time</span><span class="sh_symbol">(</span>NULL<span class="sh_symbol">));</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>TIME_LIMIT <span class="sh_symbol">=</span> CLOCKS_PER_SEC <span class="sh_symbol">*</span> <span class="sh_number">7</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">4</span><span class="sh_symbol">;</span> <span class="sh_function">clock</span><span class="sh_symbol">()</span> <span class="sh_symbol">&lt;</span> TIME_LIMIT<span class="sh_symbol">;</span> <span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
        <span class="sh_keyword">do</span> <span class="sh_cbracket">{</span>u <span class="sh_symbol">=</span> <span class="sh_function">rand</span><span class="sh_symbol">()</span> <span class="sh_symbol">%</span> n<span class="sh_symbol">;</span> v <span class="sh_symbol">=</span> <span class="sh_function">rand</span><span class="sh_symbol">()</span> <span class="sh_symbol">%</span> n<span class="sh_symbol">;</span><span class="sh_cbracket">}</span> <span class="sh_keyword">while</span><span class="sh_symbol">(</span>u <span class="sh_symbol">==</span> v<span class="sh_symbol">);</span>
        <span class="sh_function">getLine</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>u<span class="sh_symbol">],</span> a<span class="sh_symbol">[</span>v<span class="sh_symbol">],</span> A<span class="sh_symbol">,</span> B<span class="sh_symbol">,</span> C<span class="sh_symbol">);</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> threshold<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            j <span class="sh_symbol">=</span> <span class="sh_function">rand</span><span class="sh_symbol">()</span> <span class="sh_symbol">%</span> n<span class="sh_symbol">;</span>
            <span class="sh_function">getSymmetry</span><span class="sh_symbol">(</span>a<span class="sh_symbol">[</span>j<span class="sh_symbol">],</span> A<span class="sh_symbol">,</span> B<span class="sh_symbol">,</span> C<span class="sh_symbol">);</span> <span class="sh_comment">// get reflex point</span>
            <span class="sh_keyword">if</span><span class="sh_symbol">(</span><span class="sh_function">Check</span><span class="sh_symbol">()</span> <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_keyword">break</span><span class="sh_symbol">;</span>
        <span class="sh_cbracket">}</span>
        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>i <span class="sh_symbol">==</span> threshold <span class="sh_symbol">&amp;&amp;</span> <span class="sh_function">CarefulCheck</span><span class="sh_symbol">())</span> <span class="sh_keyword">return</span> <span class="sh_function">quit</span><span class="sh_symbol">(</span><span class="sh_string">"YES"</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">return</span> <span class="sh_function">quit</span><span class="sh_symbol">(</span><span class="sh_string">"NO"</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p><strong>坑1：</strong>由于两点确定直线方程 $Ax + By + C = 0$ 中的 $A, B, C$ 时涉及到向量模长的计算，又浮点数的误差较大 (实测数据中会有某些点满足 $a^2 + b^2 = c^2 + d^2$，然后<strong>用 <code>long double</code> 计算</strong> $(a^2 + b^2) - (c^2 + d^2)$ 后<strong>不</strong>为 $0$，因此只能用整数计算，又读入已经是 <code>long long</code>，所以计算时<strong>要用 <code>__int128</code></strong>。</p>
<p style="color: red">ps: 设 $\vec{p_i} = (x_i, y_i), \vec{p_j} = (x_j, y_j)$，则 $$ \overline{p_ip_j}: 2 \left( \vec{p_j} - \vec{p_i} \right) \cdot (x, y) + \left( \vec{p_i}^2 - \vec{p_j}^2 \right) = 0 $$</p>
<p><strong>坑2：</strong>算出方程算对称点的时候，<strong>可以使用 <code>long double</code> 计算</strong> <del>(<code>long long</code>判整点需要取模，有点慢)</del>，然后<strong>四舍五入</strong>到一个 <code>long long</code>，如果那个 <code>long double</code> 是 $\mathrm{\overline{xxx.5x}}$ 的形式，就可以明确它不是整点了。但 <code>eps</code> 也不能太小，经测试，因为由于 <code>long double</code> 的误差，结果可能会与答案相差个 $10^{-6}$ 左右，上面代码 <code>eps = 1e-5</code> 是可以的。</p>
<p><strong>坑3：</strong>在最终检验 (即随机检验通过后的检验)，上面说过，可以使用配对检验，因此在 "判断点是否在集合中" 的同时还需要给出它对应的点的编号，依次可以使用 <code>map</code>/<code>hash_map</code>。</p>
<p><strong>坑4：</strong>在写 <code>hash_set</code>/<code>hash_map</code> 等的邻接表时，如果数组有 $0$ 号元素，一定要记得<strong>把初始的 <code>first[]</code> 数组置为 $-1$ (或其它未出现元素)！</strong></p>
