<!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<meta charset="utf-8">
		<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
		<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
		<title>分圆多项式</title>
		<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
		<script src="../additional_files/js/sh_main.min.js"></script>
		<script src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>
		<style>
			dfn {font-weight: bold; color: fuchsia}
			.th {font-weight: bold; color: green}
			.pr {font-weight: bold; color: orange}
		</style>
	</head>
	<body>
		<h3>分圆多项式</h3>
		<p><strong style="color: red">前置技能：多项式基础。</strong></p>
		<ol>
			<li><p>在复数域 $\mathbb C$ 中，多项式 $x^n - 1$ 有 $n$ 个根：$\cos \dfrac {2 \pi k} n + \mathrm i \sin \dfrac {2 \pi k} n, k = 0, 1, \ \cdots, n - 1$。由 Euler 公式，可以写作 $\mathrm e^{2 \pi \mathrm i k / n} = \exp \dfrac {2 \pi \mathrm i k} n$。</p>
			<p>以下为了方便，记 $\omega_n = \exp \dfrac {2 \pi \mathrm i} n$，则 $\omega_n^k = \left( \omega_n \right)^k = \exp \dfrac {2 \pi \mathrm i k} n$。在上下文已知的情况下，可以用 $\omega$ 代替 $\omega_n$ (在某些文献中，用 $\varepsilon$ 表达相同的含义)。</p>
			<p>根据上述记号，$x^n - 1$ 的 $n$ 个根可以记作 $1, \omega, \omega^2, \cdots, \omega^{n-1}$。</p>
			<p>因此，由 Vieta 定理 (根与系数的关系)，可以得到</p>
			<p id="pr-1-1" class="pr">性质 1.1：$x^n - 1 = \left( x - 1 \right) \left( x - \omega \right) \left( x - \omega^2 \right) \cdots \left( x - \omega^{n-1} \right)$。</p>
			<p>由初中的因式分解技巧，有 $x^n - 1 = \left( x - 1 \right) \left( x^{n-1} + x^{n-2} + \cdots + x + 1 \right)$，于是就有</p>
			<p id="co-1-1" class="pr">推论 1.1：$x^{n-1} + x^{n-2} + \cdots + x + 1 = \left( x - \omega \right) \left( x - \omega^2 \right) \cdots \left( x - \omega^{n-1} \right)$。</p>
			<p>在上式中代入任何一个 $\omega_n^i$，即可得到：</p>
			<p id="co-1-2" class="pr">推论 1.2：$1 + \omega_n^k + \omega_n^{2k} + \cdots + \omega_n^{(n-1) k} = \begin{cases} 0 &amp; n \nmid k \\ n &amp; n \mid k \end{cases}$。</p></li>
			<li><p>由公式 $\omega_n^k = \exp \dfrac {2 \pi \mathrm i k} n$ 得知，$1, \omega_n, \omega_n^2, \cdots, \omega_n^{n-1}$ 关于<strong>乘法运算 $\cdot$</strong> 构成了一个 <strong>$n$ 阶循环群</strong> $\Omega_n$ (被称为<dfn>单位根群 (Group of root or unity)</dfn>)，其中 $\omega_n$ 是 $\Omega_n$ 的一个生成元。</p>
			<p>从而有 $\omega_n^a \cdot \omega_n^b = \omega_n^{a + b}$，$\left( \omega_n^a \right)^b = \omega_n^{ab}$，$\omega_n^k = \omega_{\lambda n}^{\lambda k}$，以及特殊地 $\overline {\omega_n^k} = \omega_n^{-k}$。</p>
			<p>提到群，自然就会想到它的生成元。那哪些元素会成为它的生成元呢？</p>
			<p>如果一个单位根，比如 $\omega_6^2 = \dfrac {-1 + \sqrt 3 \mathrm i} 2$，它其实也是一个 $3$ 次的单位根，因此它所生成的所有单位根都是 $3$ 次的，而不会生成 $\omega_6 = \dfrac {1 + \sqrt 3 \mathrm i} 2$。</p>
			<p>由有限循环群的结论，$\omega_n^k$ 是 $\Omega_n$ 的生成元，当且仅当 $n \perp k$，即 $(n, k) = 1$。因此，这些满足 $n \perp k$ 的单位根 $\omega_n^k$ 有着特殊的性质，这就是我们即将讨论的重点。</p></li>
			<li><p>如果一个 $n$ 阶单位根 $\omega_n^k$，满足对于任意的 $i = 1, 2, \cdots, n - 1$，$\omega_n^{k \cdot i} \neq 1$ (即 $\omega_n^k$ 是群 $\Omega_n$ 的生成元)，则称 $n$ 阶单位根 $\omega_n^k$ 是<dfn>本原的 (Primitive)</dfn>，$\omega_n^k$ 称为<dfn>本原单位根 (Primitive root of unity)</dfn>，简称<dfn>原根</dfn>。</p>
			<p id="th-3-1" class="th">定理 3.1：$\omega_n^k$ 是 $n$ 阶本原单位根的充要条件是 $n \perp k$。</p>
			<div class="panel panel-danger">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>设 $(n, k) = d$。若 $d \neq 1$，则取 $i = \dfrac nd \in \left[ 1, n - 1 \right]$，$\omega_n^{k \cdot i} = \omega_n^{k \cdot n/d} = \omega_n^{n \cdot k/d} = 1$，从而 $\omega_n^k$ 不是本原单位根。</p>
					<p>若 $d = 1$，反设存在 $i \in \left[ 1, n - 1 \right]$ 使得 $\omega_n^{k \cdot i} = 1$，即 $n \mid k i$，由于 $n \perp k$，故有 $n \mid i$，与 $i \in \left[ 1, n - 1 \right]$ 矛盾。</p>
				</div>
			</div>
			<p>由<a href="#th-3-1">定理 3.1</a> 可以知道，$n$ 阶的本原单位根恰有 $\phi(n)$ 个。</p>
			<p>上面提到过，以所有 $n$ 阶单位根为根的多项式为 $x^n - 1$，那么以所有 $\phi(n)$ 个 $n$ 阶本原单位根为根的多项式又有什么样的性质呢？这就是我们接下来要提到的<strong>分圆多项式</strong>。</p>
			<p>定义<dfn>分圆多项式 (Cyclotomic polynomial)</dfn> 所有以 $n$ 阶本原单位根为单根的首一多项式，记作 $\Phi_n (x)$，即</p>
			<p>$$ \Phi_n (x) = \prod_{1 \leq k \leq n \\ (k,n) = 1} \left( x - \omega_n^k \right) \tag 1 \label 1 $$</p>
			<p>注意到 $n$ 个单位根将复平面上的单位圆 $|z| = 1$ 等分成了 $n$ 等分，因此得名为分圆多项式 (Cyclotomic)。</p>
			<p>由于 $n$ 阶本原单位根一共有 $\phi(n)$ 个，因此 $n$ 阶分圆多项式的次数 $\deg \Phi_n (x) = \phi(n)$，这解释了为什么分圆多项式用 $\Phi_n (x)$ 表示。</p>
			<p>分圆多项式的一个最基础最重要的定理由下面的<a href="#th-3-2">定理 3.2</a> 给出。</p>
			<p id="th-3-2" class="th">定理 3.2：$\displaystyle \prod_{d \mid n} \Phi_d (x) = x^n - 1$。</p>
			<div class="panel panel-warning">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>我们比较两边的次数，可以发现一个喜闻乐见的事实：<span class="pr">$\displaystyle \sum_{d \mid n} \phi(d) = n$</span>。</p>
					<p>考虑我们当时证明上述结论的方法——构造 $n$ 个分母为 $n$ 的个分数。在这里我们也使用类似的证明方法，取出所有的 $n$ 阶本原单位根 $1, \omega_n, \omega_n^2, \omega_n^{k-1}$。</p>
					<p>考察其中任意一个本原单位根 $\omega_n^k$，设 $d = (n, k), n = n_1 d, k = k_1 d$ 且 $\left( n_1, k_1 \right) = 1$。则它其实就是 $\omega_{n_1}^{k_1}$，即一个 $n_1$ 阶单位根且是 $n_1$ 阶的本原单位根，这里 $n_1 \mid n$。</p>
					<p>而且，对于任意 $d \mid n$，一个 $d$ 阶的本原单位根 $\omega_d^e$ 也应该是一个 $n$ 阶单位根，因为 $\omega_d^e = \omega_{d \cdot n/d}^{e \cdot n/d} = \omega_n^{e \cdot n/d}$。</p>
					<p>从而，$n$ 阶的所有单位根与 "对于所有 $n$ 的因数 $d$，$d$ 阶的<strong>本原</strong>单位根之间存在一一对应，由<a href="#pr-1-1">性质 1.1</a>，它们的乘积就是 $x^n - 1$。</p>
				</div>
			</div>
			<p>在<a href="#th-3-2">定理 3.2</a> 的等式两端代入 $n = p$ ($p$ 是素数)，由于 $p$ 的因子只有 $1$ 和 $p$，就有 $\Phi_1 (x) \Phi_p (x) = x^p - 1$，由于 $\Phi_1 (x) = x - 1$，因此我们得到了</p>
			<p>$$ \Phi_p (x) = \frac {x^p - 1} {x - 1} = x^{p-1} + x^{p-2} + \cdots + 1 $$</p>
			<p>当 $n$ 比较小时，$\Phi_n (x)$ 的性状如下：</p>
			<img class="center-block" src="../records/uploads/1.svg" alt="\Phi_n (x) 当 n 较小时的情形" style="width: 66%" />
			<p>直觉告诉你，分圆多项式的系数一定在 $\left\{ -1, 0, 1 \right\}$ 的范围中！</p>
			<p>然而这却是假的。当 $n = 105$ 时，</p>
			<p>\begin{align*}
\Phi_{105} (x) &amp;= x^{48} + x^{47} + x^{46} - x^{43} - x^{42} - \color {red} 2 x^{41} - x^{40} - x^{39} + x^{36} + x^{35} + x^{34} + x^{33} + x^{32} + x^{31} - x^{28} - x^{26} - x^{24} - x^{22} - x^{20} \\
&amp; + x^{17} + x^{16} + x^{15} + x^{14} + x^{13} + x^{12} - x^9 - x^8 - \color {red} 2 x^7 - x^6 - x^5 + x^2 + x + 1
\end{align*}</p>
			<p>进一步，当 $n = 463505 = 5 \times 7 \times 17 \times 19 \times 41$ 时，$\Phi_n (x)$ 的绝对值最大的系数竟有 $-17310$！这也可以说明分圆多项式在 $n$ 较大时的增长速度是非常迅猛的。</p>
			<p>不过，虽然分圆多项式的系数很大，但是我们还是可以非常容易地求出它的值。因为如果对<a href="#th-3-2">定理 3.2</a> 的等式两端取<strong>对数</strong>，我们就能得到</p>
			<p>$$ \log \left( x^n - 1 \right) = \sum_{d \mid n} \log \Phi_d (x) $$</p>
			<p>可以看出，这是一个 Möbius 变换 (Dirichlet 前缀和) 的形式。因此，我们尝试使用 Möbius 反转变换，即</p>
			<p>$$ \log \Phi_n (x) = \sum_{d \mid n} \mu \left( \frac nd \right) \cdot \log \left( x^d - 1 \right) $$</p>
			<p>两边再取指数，就有</p>
			<p>$$ \Phi_n (x) = \prod_{d \mid n} \left( x^d - 1 \right)^{\mu(n/d)} \tag 2 \label 2 $$</p>
			<p>于是我们就得到了一个计算 $\Phi_n (x)$ 的表达式。这个表达式在实际应用中非常优秀，详见 <a href="../index.html?redirect=495" target="_blank">[soj83]因式分解</a>。</p>
			<p>但是那道题要求的是 $x^n - 1$ 在 $\mathbb Z$ 中的分解式，而<a href="#th-3-2">定理 3.2</a> 中的式子只是一个普通的等式。因此，如果我们要说明，那个式子<strong>真的是一个分解式</strong>，我们就要证明，<strong>所有的分圆多项式都是在 $\mathbb Z$ 中不可约 (irreducible) 的</strong>。</p></li>
			<li><p>在证明这个非常重要的定理之前，先证明一个小小的结论：</p>
			<p id="th-4-1" class="th">定理 4.1：分圆多项式是整系数多项式。</p>
			<div class="panel panel-success">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>由 $\eqref 2$，分圆多项式是有理数多项式。</p>
					<p>由高斯引理的推论，如果多项式 $f(x)$ 和整系数多项式 $g(x), h(x)$ 满足 $f(x) \cdot g(x) = h(x)$，且 $g(x), h(x)$ 都是本原多项式 (所有系数的最大公约数为 $1$)，则 $f(x)$ 是整系数多项式。</p>
					<p>由 $\eqref 1$，$\Phi_n (x)$ 是首一多项式 (首项系数为 $1$)。</p>
					<p>于是我们可以归纳证明 $\Phi_n (x)$ 是整系数的本原多项式，因为如果对于 $d &lt; n$，$\Phi_d (x)$ 都是整系数的本原多项式，由 $\eqref 2$ 及高斯引理推论，$\Phi_n (x)$ 也是整系数的本原多项式。</p>
				</div>
			</div>
			<p>注意到，如果一个整系数本原多项式在整数环 $\mathbb Z$ 内可约当且仅当它在有理数域 $\mathbb Q$ 内可约。因此我们只需证明它在整数环 $\mathbb Z$ 内不可约即可。</p>
			<p id="th-4-2" class="th">定理 4.2：分圆多项式在整数环 $\mathbb Z$ 内不可约。</p>
			<div class="panel panel-info">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>当 $n = 1, 2$ 时显然。下设 $n \geq 3$。</p>
					<p>反设 $\Phi_n (x)$ 在 $\mathbb Z$ 中可约，则可以设 $\Phi_n(x) = f(x) \cdot g(x)$，其中 $f(x)$ 是 $\mathbb Z$ 中的非平凡不可约多项式。</p>
					<p>设 $\varepsilon$ 为 $f$ 的一个根，由于 $\deg g \geq 1$，因此 $g$ 至少有一个根 $\eta$。由于与 $n$ 互素的数的集合 (模 $n$ 的简化剩余系) 关于乘法 $\cdot$ 构成一个群，因此对于 $g$ 的每一个根 $\eta$，一定存在 $B \perp n, 1 \leq B \leq n - 1$ 使得 $\eta = \varepsilon^B$。</p>
					<p>对于一个固定的 $\varepsilon$，我们适当地取 $\eta$ 使得 $B$ 最小。然后变动 $\varepsilon$，再使得 $B$ 最小。</p>
					<p class="pr">先证明一个引理：最小的 $B$ 一定是一个素数。</p>
					<p>反之，设 $B = p \cdot q$，其中 $p$ 是一个素数，那么显然有 $q \perp n$。考察 $\varepsilon^q$，由 $B$ 的最小性，它不能是 $g$ 的根，而它又是 $\Phi_n$ 的根，因此只能是 $f$ 的根。因此，此时我们令 $\epsilon' = \epsilon^q$，则 $\epsilon'^p$ 就是 $g$ 的根，从而有 $B' = p &lt; B$，这与 $B$ 的最小性矛盾。因此 $B$ 是素数，<span class="pr">引理证毕</span>。</p>
					<p>考察两个多项式 $f \left( x \right)$ 和 $g \left( x^B \right)$，由于将 $\epsilon$ 代入后有 $f \left( \epsilon \right) = g \left( \epsilon^B \right) = 0$，因此有 $\gcd \left( f(x), g \left( x^B \right) \right) \succ 1$ ($f(x) \succ 1$ 指的是多项式 $f$ 的次数 $\deg f \geq 1$)，又由 $f(x)$ 的不可约性，故有 $f(x) \mid g \left( x^B \right)$。</p>
					<p>那么在模 $B$ 的意义下，依然有 $f(x) \mid g \left( x^B \right) \pmod B$，注意到模意义下的二项式定理：$\left( a + b + \cdots + z \right)^p \equiv a^p + b^p + \cdots + z^p \pmod p$ ($p$ 是素数)，于是对任一整系数多项式 $f(x)$，均有 $f^p (x) \equiv f \left( x^p \right) \pmod p$。</p>
					<p>因此，在模 $B$ 意义下，$g \left( x^B \right) \equiv g^B \left( x \right)$，因此有 $f(x) \mid g^B \left( x \right)$。</p>
					<p>由于 $f(x) \mid g^B (x)$，因此在模 $B$ 意义下一定有 $\gcd \left( f(x), g(x) \right) \succ 1$。</p>
					<p>(否则如果 $\gcd \left( f(x), g(x) \right) = 1$，由 Bézout 定理，存在 $q, r$ 满足 $f q + g r = 1$，从而可以归纳证明对于 $\forall k &gt; 1$，存在多项式 $q_k, r_k$ 满足 $f q_k + g^k r_k = 1$，与 $f \mid g^B$ 矛盾)</p>
					<p>设 $r(x) = \gcd \left( f(x), g(x) \right)$，则有 $r(x) \mid f(x), r(x) \mid g(x)$，从而有 $r^2(x) \mid f(x) g(x) = \Phi_n (x) \mid x^n - 1$。</p>
					<p>设 $x^n - 1 = r^2 (x) U(x)$，对其两边求导，有 $n x^{n-1} = r(x) \left( 2 r'(x) U(x) + r(x) U'(x) \right)$，即 $r(x) \mid \gcd \left( x^n - 1, n x^{n-1} \right)$。</p>
					<p>而 $B \perp n$，因此存在 $n^{-1}$，使得 $\left( x^n - 1 \right) \cdot (-1) + \left( n x^{n-1} \right) \cdot \left( n^{-1} x \right) = 1$，故 $\gcd \left( x^n - 1, n x^{n-1} \right) = 1$。</p>
					<p>因此 $r(x) \mid 1 \Rightarrow r(x) = 1$，与 $\gcd \left( f(x), g(x) \right) \succ 1$ 矛盾，原结论成立。</p>
				</div>
			</div>
			<p>因此，<a href="#th-3-2">定理 3.2</a> 所给出的式子就是 $x^n - 1$ 在 $\mathbb Z$ 中的因式分解式。因此，现在我们对分圆多项式赋予了一个新的意义：</p>
			<p id="co-4-1" class="pr">推论 4.1：$\Phi_n (x)$ 是 $x^n - 1$ 的因式分解式中唯一一个不是其它 $x^d - 1$ 的因式的既约多项式，其中 $d \mid n$。</p></li>
			<li><p>分圆多项式还有许多精妙的性质，现列举如下：</p>
			<p id="th-5-1" class="th">定理 5.1：设 $n &gt; 1$，则分圆多项式的系数是对称的，即 $\Phi_n (x) = x^{\phi(n)} \Phi_n \left( \dfrac 1x \right)$。</p>
			<div class="panel panel-danger">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>考虑使用 $\eqref 2$ 式，我们将 $\dfrac 1x$ 代入 $x^d - 1$ 时，它会变成 $\dfrac 1 {x^d} - 1$，乘上 $x^d$ 后就变为 $1 - x^d$，也就相当于乘上一个 $-1$。</p>
					<p>因此我们只需证明 $\eqref 2$ 式中 $\mu$ 非零的项数为偶数即可。</p>
					<p>而这个数值等于 $2^{\omega(n)}$，因此对 $n &gt; 1$ 必有 $\omega(n) \geq 1$，因此它当然是偶数啦。</p>
				</div>
			</div>
			<p>考察分圆多项式的一次项和次高次项，我们有：</p>
			<p id="th-5-2" class="th">定理 5.2：设 $n &gt; 1$，则 $\Phi_n (x)$ 的一次项系数等于 $-\mu(n)$。</p>
			<p>证明的话还是通过 $\eqref 2$ 式，细节就留给读者了。</p>
			<p>对于 $n$ 次的本原单位根 $\epsilon$，有 $\Phi \left( \epsilon \right) = 0$，那么对于其它根，情况又会怎么样呢？</p>
			<p>这个问题还是有少许复杂的，不过我们可以考虑 $\Phi(1)$，由于 $\Phi(n)$ 是整系数多项式，因此 $\Phi(1)$ 一定是一个整数，那它等于多少呢？</p>
			<p>这其实是一个数论问题，结论是：</p>
			<p id="th-5-3" class="th">定理 5.3：$\Phi_n (1) = \begin{cases} p &amp; \exists p \in \mathbb P, \alpha \in \mathbb N^*, \textrm{ s.t. } n = p^\alpha \\ 1 &amp; \textrm{otherwise} \end{cases}$。</p>
			<div class="panel panel-warning">
				<div class="panel-heading">证明</div>
				<div class="panel-body">
					<p>$n = 1$ 时容易验证。以下考虑 $n &gt; 1$ 的情形。</p>
					<p>注意到等式 $\displaystyle \log \Phi_n (x) = \sum_{d \mid n} \mu \left( \frac nd \right) \cdot \log \left( x^d - 1 \right)$，由于 $x^d - 1 = (x - 1) \cdot \left( x^{d-1} + x^{d-2} + \cdots + x + 1 \right)$，因此有</p>
					<p>$$ \log \Phi_n (x) = \sum_{d \mid n} \mu \left( \frac nd \right) \cdot \left( \log (x - 1) + \log \left( x^{d-1} + x^{d-2} + \cdots + x + 1 \right) \right) $$</p>
					<p>由于 $n &gt; 1$ 时，$\displaystyle \sum_{d \mid n} \mu \left( \frac nd \right) = 0$，因此由极限的思想，</p>
					<p>$$ \log \Phi_n (1) = \sum_{d \mid n} \mu \left( \frac nd \right) \log d $$</p>
					<p>也就是说，它是 $\mu$ 与 $\log$ 的 Dirichlet 卷积。</p>
					<p>由数论的熟知结论，$\mu$ 与 $\log$ 的 Dirichlet 卷积被称作 Von Mangoldt 函数，记作 $\Lambda(n)$，满足</p>
					<p>$$ \Lambda(n) = \begin{cases} \log p &amp; \exists p \in \mathbb P, \alpha \in \mathbb N^*, \textrm{ s.t. } n = p^\alpha \\ 0 &amp; \textrm{otherwise} \end{cases} $$</p>
					<p>因此两边取指数后结论成立。</p>
				</div>
			</div></li>
		</ol>
	</body>
</html>
