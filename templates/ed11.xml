<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../additional_files/css/pgmain.min.css"?>
<?xml-stylesheet type="text/css" href="../additional_files/css/sh_typical.min.css"?>

<template>
<title>Nim ç§¯ (32/64 bit)</title>
<pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_keyword">namespace</span> nimbers <span class="sh_cbracket">{</span>
	constexpr <span class="sh_usertype">u32</span><span class="sh_normal"> </span>n2f<span class="sh_symbol">[</span><span class="sh_number">16</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_number">0x0001u</span><span class="sh_symbol">,</span> <span class="sh_number">0x8ff5u</span><span class="sh_symbol">,</span> <span class="sh_number">0x6cbfu</span><span class="sh_symbol">,</span> <span class="sh_number">0xa5beu</span><span class="sh_symbol">,</span> <span class="sh_number">0x761au</span><span class="sh_symbol">,</span> <span class="sh_number">0x8238u</span><span class="sh_symbol">,</span> <span class="sh_number">0x4f08u</span><span class="sh_symbol">,</span> <span class="sh_number">0x95acu</span><span class="sh_symbol">,</span> <span class="sh_number">0xf340u</span><span class="sh_symbol">,</span> <span class="sh_number">0x1336u</span><span class="sh_symbol">,</span> <span class="sh_number">0x7d5eu</span><span class="sh_symbol">,</span> <span class="sh_number">0x86e7u</span><span class="sh_symbol">,</span> <span class="sh_number">0x3a47u</span><span class="sh_symbol">,</span> <span class="sh_number">0xe796u</span><span class="sh_symbol">,</span> <span class="sh_number">0xb7c3u</span><span class="sh_symbol">,</span> <span class="sh_number">0x0008u</span><span class="sh_cbracket">}</span><span class="sh_symbol">,</span>
				  f2n<span class="sh_symbol">[</span><span class="sh_number">16</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_number">0x0001u</span><span class="sh_symbol">,</span> <span class="sh_number">0x2827u</span><span class="sh_symbol">,</span> <span class="sh_number">0x392bu</span><span class="sh_symbol">,</span> <span class="sh_number">0x8000u</span><span class="sh_symbol">,</span> <span class="sh_number">0x20fdu</span><span class="sh_symbol">,</span> <span class="sh_number">0x4d1du</span><span class="sh_symbol">,</span> <span class="sh_number">0xde4au</span><span class="sh_symbol">,</span> <span class="sh_number">0x0a17u</span><span class="sh_symbol">,</span> <span class="sh_number">0x3464u</span><span class="sh_symbol">,</span> <span class="sh_number">0xe3a9u</span><span class="sh_symbol">,</span> <span class="sh_number">0x6d8du</span><span class="sh_symbol">,</span> <span class="sh_number">0x34bcu</span><span class="sh_symbol">,</span> <span class="sh_number">0xa921u</span><span class="sh_symbol">,</span> <span class="sh_number">0xa173u</span><span class="sh_symbol">,</span> <span class="sh_number">0x0ebcu</span><span class="sh_symbol">,</span> <span class="sh_number">0x0e69u</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
	<span class="sh_keyword">inline</span> <span class="sh_usertype">u32</span><span class="sh_normal"> </span><span class="sh_function">nimber2field</span><span class="sh_symbol">(</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>x<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>y <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_keyword">for</span> <span class="sh_symbol">(;</span> x<span class="sh_symbol">;</span> x <span class="sh_symbol">&amp;=</span> x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> y <span class="sh_symbol">^=</span> n2f<span class="sh_symbol">[</span><span class="sh_function">ctz</span><span class="sh_symbol">(</span>x<span class="sh_symbol">)];</span> <span class="sh_keyword">return</span> y<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
	<span class="sh_keyword">inline</span> <span class="sh_usertype">u32</span><span class="sh_normal"> </span><span class="sh_function">field2nimber</span><span class="sh_symbol">(</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>x<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>y <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> <span class="sh_keyword">for</span> <span class="sh_symbol">(;</span> x<span class="sh_symbol">;</span> x <span class="sh_symbol">&amp;=</span> x <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> y <span class="sh_symbol">^=</span> f2n<span class="sh_symbol">[</span><span class="sh_function">ctz</span><span class="sh_symbol">(</span>x<span class="sh_symbol">)];</span> <span class="sh_keyword">return</span> y<span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
	<span class="sh_keyword">inline</span> u32 <span class="sh_function">__builtin_double</span><span class="sh_symbol">(</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>x<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> x <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span> <span class="sh_symbol">^</span> <span class="sh_symbol">(</span>x <span class="sh_symbol">&lt;</span> <span class="sh_number">0x8000u</span> <span class="sh_symbol">?</span> <span class="sh_number">0</span> <span class="sh_symbol">:</span> <span class="sh_number">0x1681fu</span><span class="sh_symbol">);</span><span class="sh_cbracket">}</span>

	<span class="sh_usertype">u16</span><span class="sh_normal"> </span>ln<span class="sh_symbol">[</span><span class="sh_number">65536</span><span class="sh_symbol">],</span> exp<span class="sh_symbol">[</span><span class="sh_number">131075</span><span class="sh_symbol">],</span> <span class="sh_symbol">*</span>Hexp <span class="sh_symbol">=</span> exp <span class="sh_symbol">+</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_symbol">*</span>H2exp <span class="sh_symbol">=</span> exp <span class="sh_symbol">+</span> <span class="sh_number">6</span><span class="sh_symbol">;</span>

	<span class="sh_keyword">inline</span> <span class="sh_type">void</span> <span class="sh_function">init</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span>
		<span class="sh_type">int</span> i<span class="sh_symbol">;</span>
		<span class="sh_keyword">for</span> <span class="sh_symbol">(*</span>exp <span class="sh_symbol">=</span> i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">65535</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> exp<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">__builtin_double</span><span class="sh_symbol">(</span>exp<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">]);</span>
		<span class="sh_keyword">for</span> <span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">65535</span><span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span> exp<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">field2nimber</span><span class="sh_symbol">(</span>exp<span class="sh_symbol">[</span>i<span class="sh_symbol">]),</span> ln<span class="sh_symbol">[</span>exp<span class="sh_symbol">[</span>i<span class="sh_symbol">]]</span> <span class="sh_symbol">=</span> i<span class="sh_symbol">;</span>
		<span class="sh_function">memcpy</span><span class="sh_symbol">(</span>exp <span class="sh_symbol">+</span> <span class="sh_number">65535</span><span class="sh_symbol">,</span> exp<span class="sh_symbol">,</span> <span class="sh_number">131070</span><span class="sh_symbol">);</span>
		<span class="sh_function">memcpy</span><span class="sh_symbol">(</span>exp <span class="sh_symbol">+</span> <span class="sh_number">131070</span><span class="sh_symbol">,</span> exp<span class="sh_symbol">,</span> <span class="sh_number">10</span><span class="sh_symbol">);</span>
	<span class="sh_cbracket">}</span>

	<span class="sh_keyword">inline</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span><span class="sh_function">product</span><span class="sh_symbol">(</span><span class="sh_usertype">u16</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span>B<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> A <span class="sh_symbol">&amp;&amp;</span> B <span class="sh_symbol">?</span> exp<span class="sh_symbol">[</span>ln<span class="sh_symbol">[</span>A<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> ln<span class="sh_symbol">[</span>B<span class="sh_symbol">]]</span> <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
	<span class="sh_keyword">inline</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span><span class="sh_function">H</span><span class="sh_symbol">(</span><span class="sh_usertype">u16</span><span class="sh_normal"> </span>A<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> A <span class="sh_symbol">?</span> Hexp<span class="sh_symbol">[</span>ln<span class="sh_symbol">[</span>A<span class="sh_symbol">]]</span> <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
	<span class="sh_keyword">inline</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span><span class="sh_function">H2</span><span class="sh_symbol">(</span><span class="sh_usertype">u16</span><span class="sh_normal"> </span>A<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> A <span class="sh_symbol">?</span> H2exp<span class="sh_symbol">[</span>ln<span class="sh_symbol">[</span>A<span class="sh_symbol">]]</span> <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
	<span class="sh_keyword">inline</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span><span class="sh_function">Hproduct</span><span class="sh_symbol">(</span><span class="sh_usertype">u16</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> <span class="sh_usertype">u16</span><span class="sh_normal"> </span>B<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> A <span class="sh_symbol">&amp;&amp;</span> B <span class="sh_symbol">?</span> Hexp<span class="sh_symbol">[</span>ln<span class="sh_symbol">[</span>A<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> ln<span class="sh_symbol">[</span>B<span class="sh_symbol">]]</span> <span class="sh_symbol">:</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>

	<span class="sh_keyword">inline</span> <span class="sh_usertype">u32</span><span class="sh_normal"> </span><span class="sh_function">product</span><span class="sh_symbol">(</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> <span class="sh_usertype">u32</span><span class="sh_normal"> </span>B<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
		<span class="sh_usertype">u16</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> A <span class="sh_symbol">&amp;</span> <span class="sh_number">65535</span><span class="sh_symbol">,</span> b <span class="sh_symbol">=</span> B <span class="sh_symbol">&amp;</span> <span class="sh_number">65535</span><span class="sh_symbol">,</span> c <span class="sh_symbol">=</span> A <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">16</span><span class="sh_symbol">,</span> d <span class="sh_symbol">=</span> B <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">16</span><span class="sh_symbol">,</span> e <span class="sh_symbol">=</span> <span class="sh_function">product</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> b<span class="sh_symbol">);</span>
		<span class="sh_keyword">return</span> <span class="sh_function">u32</span><span class="sh_symbol">(</span><span class="sh_function">product</span><span class="sh_symbol">(</span><span class="sh_function">u16</span><span class="sh_symbol">(</span>a <span class="sh_symbol">^</span> c<span class="sh_symbol">),</span> <span class="sh_function">u16</span><span class="sh_symbol">(</span>b <span class="sh_symbol">^</span> d<span class="sh_symbol">))</span> <span class="sh_symbol">^</span> e<span class="sh_symbol">)</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">16</span> <span class="sh_symbol">|</span> <span class="sh_symbol">(</span><span class="sh_function">Hproduct</span><span class="sh_symbol">(</span>c<span class="sh_symbol">,</span> d<span class="sh_symbol">)</span> <span class="sh_symbol">^</span> e<span class="sh_symbol">);</span>
	<span class="sh_cbracket">}</span>

	<span class="sh_keyword">inline</span> <span class="sh_usertype">u32</span><span class="sh_normal"> </span><span class="sh_function">H</span><span class="sh_symbol">(</span><span class="sh_usertype">u32</span><span class="sh_normal"> </span>A<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
		<span class="sh_usertype">u16</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> A <span class="sh_symbol">&amp;</span> <span class="sh_number">65535</span><span class="sh_symbol">,</span> b <span class="sh_symbol">=</span> A <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">16</span><span class="sh_symbol">;</span>
		<span class="sh_keyword">return</span> <span class="sh_function">H</span><span class="sh_symbol">(</span><span class="sh_function">u16</span><span class="sh_symbol">(</span>a <span class="sh_symbol">^</span> b<span class="sh_symbol">))</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">16</span> <span class="sh_symbol">|</span> <span class="sh_function">H2</span><span class="sh_symbol">(</span>b<span class="sh_symbol">);</span>
	<span class="sh_cbracket">}</span>

	<span class="sh_keyword">inline</span> <span class="sh_usertype">u64</span><span class="sh_normal"> </span><span class="sh_function">product</span><span class="sh_symbol">(</span><span class="sh_usertype">u64</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span> <span class="sh_usertype">u64</span><span class="sh_normal"> </span>B<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
		<span class="sh_usertype">u32</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> A <span class="sh_symbol">&amp;</span> UINT_MAX<span class="sh_symbol">,</span> b <span class="sh_symbol">=</span> B <span class="sh_symbol">&amp;</span> UINT_MAX<span class="sh_symbol">,</span> c <span class="sh_symbol">=</span> A <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">32</span><span class="sh_symbol">,</span> d <span class="sh_symbol">=</span> B <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">32</span><span class="sh_symbol">,</span> e <span class="sh_symbol">=</span> <span class="sh_function">product</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> b<span class="sh_symbol">);</span>
		<span class="sh_keyword">return</span> <span class="sh_function">u64</span><span class="sh_symbol">(</span><span class="sh_function">product</span><span class="sh_symbol">(</span>a <span class="sh_symbol">^</span> c<span class="sh_symbol">,</span> b <span class="sh_symbol">^</span> d<span class="sh_symbol">)</span> <span class="sh_symbol">^</span> e<span class="sh_symbol">)</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">32</span> <span class="sh_symbol">|</span> <span class="sh_symbol">(</span><span class="sh_function">H</span><span class="sh_symbol">(</span><span class="sh_function">product</span><span class="sh_symbol">(</span>c<span class="sh_symbol">,</span> d<span class="sh_symbol">))</span> <span class="sh_symbol">^</span> e<span class="sh_symbol">);</span>
	<span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span></code></pre>
</template>
