<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/css" href="../additional_files/css/pgmain.min.css"?>
<?xml-stylesheet type="text/css" href="../additional_files/css/sh_typical.min.css"?>

<template>
<title>自适应 Simpson 积分</title>
<pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_type">double</span> <span class="sh_function">Simpson</span><span class="sh_symbol">(</span><span class="sh_type">double</span> L<span class="sh_symbol">,</span> <span class="sh_type">double</span> M<span class="sh_symbol">,</span> <span class="sh_type">double</span> R<span class="sh_symbol">,</span> <span class="sh_type">double</span> fL<span class="sh_symbol">,</span> <span class="sh_type">double</span> fM<span class="sh_symbol">,</span> <span class="sh_type">double</span> fR<span class="sh_symbol">,</span> <span class="sh_type">double</span> eps<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span>
	<span class="sh_type">double</span> LM <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>L <span class="sh_symbol">+</span> M<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_number">0.5</span><span class="sh_symbol">,</span> fLM <span class="sh_symbol">=</span> <span class="sh_function">f</span><span class="sh_symbol">(</span>LM<span class="sh_symbol">),</span> MR <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>M <span class="sh_symbol">+</span> R<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_number">0.5</span><span class="sh_symbol">,</span> fMR <span class="sh_symbol">=</span> <span class="sh_function">f</span><span class="sh_symbol">(</span>MR<span class="sh_symbol">);</span>
	<span class="sh_type">double</span> A <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>fL <span class="sh_symbol">+</span> fM <span class="sh_symbol">*</span> <span class="sh_number">4.0</span> <span class="sh_symbol">+</span> fR<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>R <span class="sh_symbol">-</span> L<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> sixth<span class="sh_symbol">,</span>
		   AL <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>fL <span class="sh_symbol">+</span> fLM <span class="sh_symbol">*</span> <span class="sh_number">4.0</span> <span class="sh_symbol">+</span> fM<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>M <span class="sh_symbol">-</span> L<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> sixth<span class="sh_symbol">,</span>
		   AR <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>fM <span class="sh_symbol">+</span> fMR <span class="sh_symbol">*</span> <span class="sh_number">4.0</span> <span class="sh_symbol">+</span> fR<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>R <span class="sh_symbol">-</span> M<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> sixth<span class="sh_symbol">;</span>
	<span class="sh_keyword">if</span> <span class="sh_symbol">(</span><span class="sh_function">fabs</span><span class="sh_symbol">(</span>AL <span class="sh_symbol">+</span> AR <span class="sh_symbol">-</span> A<span class="sh_symbol">)</span> <span class="sh_symbol">&lt;</span> eps<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_symbol">(</span><span class="sh_number">2.0</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>AL <span class="sh_symbol">+</span> AR<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> A<span class="sh_symbol">)</span> <span class="sh_symbol">*</span> third<span class="sh_symbol">;</span>
	<span class="sh_keyword">return</span> <span class="sh_function">Simpson</span><span class="sh_symbol">(</span>L<span class="sh_symbol">,</span> LM<span class="sh_symbol">,</span> M<span class="sh_symbol">,</span> fL<span class="sh_symbol">,</span> fLM<span class="sh_symbol">,</span> fM<span class="sh_symbol">,</span> eps <span class="sh_symbol">*</span> <span class="sh_number">0.6</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_function">Simpson</span><span class="sh_symbol">(</span>M<span class="sh_symbol">,</span> MR<span class="sh_symbol">,</span> R<span class="sh_symbol">,</span> fM<span class="sh_symbol">,</span> fMR<span class="sh_symbol">,</span> fR<span class="sh_symbol">,</span> eps <span class="sh_symbol">*</span> <span class="sh_number">0.6</span><span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span></code></pre>
</template>
