### 题目描述

有一个网格，网格中有 $N$ 行 $N$ 列。让 $(i,j)$ 表示从上面起第 $i$ 行和从左边起第 $j$ 列的方格。

高桥最初在 $(1,1)$ 个方格中的钱为零。

当高桥在 $(i,j)$ 号方格时，他可以在**一次**行动中完成以下其中一项：

- 停留在同一位置并增加 $P_{i,j}$ 的钱数。
- 从他的钱中支付 $R_{i,j}$ 并移动到 $(i,j+1)$ 格。
- 从他的钱中支付 $D_{i,j}$ 并移动到 $(i+1,j)$ 格。

他不会采取会使他的金钱变为负数或使他离开网格的一次行动。

如果高桥采取最优行动，他需要多少次行动才能到达 $(N,N)$ 位置？

### 数据范围

$2 \leq N \leq 80,1 \leq P_{i,j} \leq 10^9$

$1 \leq R_{i,j},D_{i,j} \leq 10^9$

### 题解

考虑DP，最朴素的想法是设 $f(x,y,mx,res)$ 表示当前在 $(x,y)$，路径中最大的值为 $mx$，剩余的钱数为 $res$ 的最小步数，转移平凡。

不难发现每次停留必定是在已经走过的格子中 $P$ 最大的位置，否则在前面停留一定更好，那么我们只用关注 $P$ 递增的子序列，其余的部分我们一定不会在那里停留，所以状态可以优化为 $f(x,y,res)$，若 $P_{c,d}>P_{a,b}$，那么沿着从 $(a,b)$ 到 $(c,d)$ 的最短路移动，计算缺少的钱需要在 $(a,b)$ 处停留多久才能赚够即可。

更进一步地，我们发现其实 $res$ 并不需要维护——假设前面在某个节点处多停留了一天，取得了一些冗余的钱，那我们换成在当前位置 $(a,b)$ 停留一定赚得更多。

所以不需要考虑需不需要多停留若干天赚更多钱，缺少的直接在当前位置赚回来更优，我们只需要尽可能压缩天数即可。

那么现在设 $f(x,y)=(k,res)$ 表示到达 $(x,y)$ 时的最小天数为 $k$，在最小化天数的情况下最多剩下 $res$ 块钱即可转移。

时间复杂度 $\mathcal O(n^4)$。

### 代码

