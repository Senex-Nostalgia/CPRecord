---
tags:
  - 计算几何
  - 题解
---
### 题目描述
平面上有 $n$ 个点和 $m$ 个圆，没有一个点在圆之间，也没有一对点的连线恰好与圆相切，若点 $u$ 与点 $v$ 连成的线段不经过任何一个圆，那么在这两个点之间连一条边，求形成的图联通块的数量。
输出答案 $-1$， $n,m\le 1000$。

### 题解

固定一个端点，考虑如何判定其他点 $v$ 是否能够到达 $u$ 。

如果只存在一个圆，如果点 $v$ 与点 $u$ 的连线经过圆，那么在靠近 $u$ 的那一侧可行，否则不可行。

更形式化的说，要在 $u$ 到圆的两条切线组成的扇形之中。

把所有切线拿出来按极角排序，按旋转一周的顺序遍历。每次进入一个扇形就将这个扇形的半径（点到切点距离）加入，离开扇形就删除。每次判定 $v$ 到 $u$ 的距离是否比最小的扇形半径更小。




