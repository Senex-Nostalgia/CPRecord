<h3 id="题目描述">题目描述</h3>
<p>有一个长度为 <span class="math inline">\(n\)</span>
的序列，一开始序列中的所有元素均为 <span
class="math inline">\(0\)</span>。另外还有 <span
class="math inline">\(m\)</span> 个操作，其中第 <span
class="math inline">\(i\)</span> 个操作会将序列中第 <span
class="math inline">\(l_i\)</span> 个元素的值改为 <span
class="math inline">\(x_i\)</span>，以及将序列中第 <span
class="math inline">\(r_i\)</span> 个元素的值改为 <span
class="math inline">\(y_i\)</span>。每个操作必须恰好执行一次。</p>
<p>求执行操作的最优顺序，使得所有操作执行完成后，序列中所有元素之和最大。</p>
<h3 id="输入格式">输入格式</h3>
<p>有多组测试数据。第一行输入一个整数 <span
class="math inline">\(T\)</span>
表示测试数据组数。对于每组测试数据：</p>
<p>第一行输入两个整数 <span class="math inline">\(n\)</span> 和 <span
class="math inline">\(m\)</span>（<span class="math inline">\(2 \leq n,
m \leq 5 \times 10^5\)</span>）表示序列的长度和操作的个数。</p>
<p>对于接下来 <span class="math inline">\(m\)</span> 行，第 <span
class="math inline">\(i\)</span> 行输入四个整数 <span
class="math inline">\(l_i\)</span>，<span
class="math inline">\(x_i\)</span>，<span
class="math inline">\(r_i\)</span> 和 <span
class="math inline">\(y_i\)</span>（<span class="math inline">\(1 \leq
l_i&lt;r_i \leq n\)</span>，<span class="math inline">\(1 \leq x_i,y_i
\leq 2\)</span>）表示第 <span class="math inline">\(i\)</span>
个操作。</p>
<p>保证所有数据 <span class="math inline">\(n\)</span> 之和与 <span
class="math inline">\(m\)</span> 之和均不超过 <span
class="math inline">\(5 \times 10^5\)</span>。</p>
<h3 id="输出格式">输出格式</h3>
<p>每组数据首先输出一行一个整数，表示执行操作后，所有元素的最大和。接下来输出一行
<span class="math inline">\(m\)</span> 个由单个空格分隔的整数 <span
class="math inline">\(a_1, a_2, \cdots, a_m\)</span>
表示执行操作的最优顺序，其中 <span class="math inline">\(a_i\)</span>
表示第 <span class="math inline">\(i\)</span> 次执行的操作的编号。从
<span class="math inline">\(1\)</span> 到 <span
class="math inline">\(m\)</span>
的每个整数（含两端）必须恰好出现一次。若有多种合法答案，您可以输出任意一种。</p>
<h3 id="题解">题解</h3>
<p>涂色首先考虑时光倒流。</p>
<p>那么我们一定会先做所有两个都是 <span class="math inline">\(2\)</span>
的操作，最后做两个都是 <span class="math inline">\(1\)</span>
的操作。</p>
<p>考虑一个 <span class="math inline">\(1\)</span> 一个 <span
class="math inline">\(2\)</span> 的操作怎么做，我们假设 <span
class="math inline">\(1\)</span> 的点是 <span
class="math inline">\(x\)</span>，<span class="math inline">\(2\)</span>
的点是 <span
class="math inline">\(y\)</span>，这种类似相互约束的东西不难考虑到到建图。</p>
<p>那么连一条 <span class="math inline">\(x\rightarrow y\)</span>
的边，不难发现对于每个强连通分量，至多一个点会是 <span
class="math inline">\(1\)</span>，并且有 <span
class="math inline">\(1\)</span> 的强连通分量在缩点后入度为 <span
class="math inline">\(0\)</span>。</p>
<p>那么先把已经确定是 <span class="math inline">\(2\)</span>
的点加入进来，再考虑所有入度为 <span class="math inline">\(0\)</span>
的强联通分量，如果里面没有已经确定的点，那么随便选一个点加入。</p>
<p>用 BFS 即可确定询问的顺序。</p>
<h3 id="代码">代码</h3>
<p>不建议参考。</p>
